var __reflect=this&&this.__reflect||function(e,t,s){e.__class__=t,s?s.push(t):s=[t],e.__types__=e.__types__?s.concat(e.__types__):s},__extends=this&&this.__extends||function(e,t){function s(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);s.prototype=t.prototype,e.prototype=new s},__awaiter=this&&this.__awaiter||function(e,t,s,n){return new(s||(s=Promise))(function(o,a){function i(e){try{h(n.next(e))}catch(t){a(t)}}function r(e){try{h(n["throw"](e))}catch(t){a(t)}}function h(e){e.done?o(e.value):new s(function(t){t(e.value)}).then(i,r)}h((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function s(e){return function(t){return n([e,t])}}function n(s){if(o)throw new TypeError("Generator is already executing.");for(;h;)try{if(o=1,a&&(i=a[2&s[0]?"return":s[0]?"throw":"next"])&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[0,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return h.label++,{value:s[1],done:!1};case 5:h.label++,a=s[1],s=[0];continue;case 7:s=h.ops.pop(),h.trys.pop();continue;default:if(i=h.trys,!(i=i.length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){h=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){h.label=s[1];break}if(6===s[0]&&h.label<i[1]){h.label=i[1],i=s;break}if(i&&h.label<i[2]){h.label=i[2],h.ops.push(s);break}i[2]&&h.ops.pop(),h.trys.pop();continue}s=t.call(e,h)}catch(n){s=[6,n],a=0}finally{o=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}var o,a,i,r,h={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),"throw":s(1),"return":s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r},GameUser=function(){function e(){this.id=0,this.name="",this.avatar="resource/art/button/E1_1",this.token="",this.pValue=0,this.tableID=0,this.isOwner=!1,this.myturn=!1,this.win=!1}return e}();__reflect(GameUser.prototype,"GameUser");var bat_match=function(e){function t(){var t=e.call(this)||this;return t._isInRoom=!1,t.isOwner=!1,t.canStartGame=!1,t._playerList=[],t._roomID="",t.default_name="待加入",t.default_rect_color=5592405,t.initView(),t}return __extends(t,e),t.prototype.initView=function(){this.btn_start=new eui.Button,this.check_closeRoom=new eui.CheckBox,this.btn_kick2=new eui.Button,this.lab_player1=new eui.Label,this.lab_player2=new eui.Label,this.rect_player1=new eui.Rect,this.rect_player2=new eui.Rect,this.lab_userID=new eui.Label,this.lab_userID1=new eui.Label,this.lab_userID2=new eui.Label,this.lab_roomID=new eui.Label,this.addMsResponseListen()},t.prototype.getChilds=function(e,t){var s=this;switch(e){case"lab_roomID":this.lab_roomID=t;break;case"lab_userID":this.lab_userID=t,this.lab_userID.text="用户："+GameData.gameUser.id+"\n"+GameData.gameUser.name;break;case"lab_lobby":this.lab_lobby=t;break;case"lab_matchmode":this.lab_matchmode=t;break;case"lab_player1":this.lab_player1=t;break;case"lab_player2":this.lab_player2=t;break;case"rect_player1":this.rect_player1=t;break;case"rect_player2":this.rect_player2=t;break;case"img_owner":this.img_owner=t,this.img_owner.visible=!1;break;case"btn_start":this.btn_start=t,this.btn_start.enabled=!1,this.btn_start.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mbuttonStartGameBtn,this);break;case"btn_return":this.btn_return=t,this.btn_return.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mbuttonLeaveRoom,this);break;case"btn_kick2":this.btn_kick2=t,this.btn_kick2.visible=!1,this.btn_kick2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnKickPlayerClick,this);break;case"check_closeRoom":this.check_closeRoom=t,this.check_closeRoom.addEventListener(egret.Event.CHANGE,function(){s.check_closeRoom.label=s.check_closeRoom.selected?"允许加入":"禁止加入",s.check_closeRoom.selected?mvs.MsEngine.getInstance.joinOpen("x"):mvs.MsEngine.getInstance.joinOver("x")},this)}},t.prototype.partAdded=function(t,s){this.getChilds(t,s),e.prototype.partAdded.call(this,t,s)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.joinRoom(this.joinFlag,this.joinInfo)},t.prototype.addMsResponseListen=function(){mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_JOINROOM_RSP,this.joinRoomResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_JOINROOM_NTFY,this.joinRoomNotify,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_JOINOVER_NTFY,this.joinOverNotify,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_JOINOVER_RSP,this.joinOverResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_JOINOPEN_RSP,this.joinOpenResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_JOINOPEN_NTFY,this.joinOpenNotify,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_SENDEVENT_RSP,this.sendEventResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_SENDEVENT_NTFY,this.sendEventNotify,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_LEAVEROOM_RSP,this.leaveRoomResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_LEAVEROOM_NTFY,this.leaveRoomNotify,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_CREATEROOM_RSP,this.createRoomResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_KICKPLAYER_RSP,this.kickPlayerResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_KICKPLAYER_NTFY,this.kickPlayerNotify,this)},t.prototype.release=function(){mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_JOINROOM_RSP,this.joinRoomResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_JOINROOM_NTFY,this.joinRoomNotify,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_JOINOVER_NTFY,this.joinOverNotify,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_JOINOVER_RSP,this.joinOverResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_SENDEVENT_RSP,this.sendEventResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_SENDEVENT_NTFY,this.sendEventNotify,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_JOINOPEN_RSP,this.joinOpenResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_JOINOPEN_NTFY,this.joinOpenNotify,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_LEAVEROOM_RSP,this.leaveRoomResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_LEAVEROOM_NTFY,this.leaveRoomNotify,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_CREATEROOM_RSP,this.createRoomResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_KICKPLAYER_RSP,this.kickPlayerResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_KICKPLAYER_NTFY,this.kickPlayerNotify,this)},t.prototype.setJoinParame=function(e,t){this.joinFlag=e,this.joinInfo=t},t.prototype.joinRoom=function(e,t){this.joinFlag=e,1==e?(this.lab_matchmode.text="（随机匹配）",this.joinRandRoom()):2==e?this.createRoom():3==e?(this.joinWithRoomID(t),this.lab_matchmode.text=""):4==e&&(GameData.syncFrame?(this.lab_matchmode.text="（帧同步匹配）",t={match:"frameSync"}):this.lab_matchmode.text="（自定义属性匹配）",this.joinRoomWithPro(t))},t.prototype.joinRandRoom=function(){var e=JSON.stringify({name:GameData.gameUser.name,avatar:GameData.gameUser.avatar});mvs.MsEngine.getInstance.joinRandomRoom(GameData.maxPlayerNum,e)},t.prototype.createRoom=function(){var e=JSON.stringify({name:GameData.gameUser.name,avatar:GameData.gameUser.avatar});mvs.MsEngine.getInstance.createRoom(GameData.createRoomInfo,e)},t.prototype.joinWithRoomID=function(e){var t=JSON.stringify({name:GameData.gameUser.name,avatar:GameData.gameUser.avatar});mvs.MsEngine.getInstance.joinRoom(e,t)},t.prototype.joinRoomWithPro=function(e){var t=JSON.stringify({name:GameData.gameUser.name,avatar:GameData.gameUser.avatar}),s=new MsMatchInfo(GameData.maxPlayerNum,0,0,e);mvs.MsEngine.getInstance.joinRoomWithProperties(s,t)},t.prototype.addPlayerList=function(e,t,s,n,o){void 0===o&&(o=!1);var a=new GameUser;return a.id=e,a.name=t,a.avatar=s,a.tableID=n,a.isOwner=o,this._playerList.push(a),this.showPlayer(a),a},t.prototype.delPlayerList=function(e){for(var t=new GameUser,s=0;s<this._playerList.length;s++)this._playerList[s].id==e&&(t.id=this._playerList[s].id,t.avatar=this._playerList[s].avatar,t.name=this._playerList[s].name,t.tableID=this._playerList[s].tableID,this._playerList.splice(s,1),this.wipePlayer(t))},t.prototype.showPlayer=function(e){this.tableID=e.tableID,this.joinFlag==t.JOINFLAG.CREATEROOM||this.joinFlag==t.JOINFLAG.WITHROOMID?(this.btn_start.visible=this.isOwner,this.img_owner.visible=this.isOwner,2==this.tableID&&(this["btn_kick"+this.tableID].visible=this.isOwner)):this.btn_start.visible=!1,this.check_closeRoom.visible=!this.canStartGame,this.check_closeRoom.enabled=this.isOwner,this["lab_player"+this.tableID].text=this.tableID.toString(),this["lab_player"+this.tableID].textColor=16777215,e.id==GameData.gameUser.id&&(this["lab_player"+this.tableID].text="我"),1==this.tableID?(this.rect_player1.fillColor=9164768,this.lab_userID1.text=e.name):2==this.tableID&&(this.rect_player2.fillColor=9889973,this.lab_userID2.text=e.name)},t.prototype.wipePlayer=function(e){var t=e.tableID;1==t?(this.lab_userID1.text=this.default_name,this.rect_player1.fillColor=this.default_rect_color,this.lab_player1.text="1",this.lab_player1.textColor=7697781,this.lab_userID2.text=this.default_name,this.rect_player2.fillColor=this.default_rect_color,this.lab_player2.text="2",this.lab_player2.textColor=7697781,this.btn_kick2.visible=!1):2==t&&(this.lab_userID2.text=this.default_name,this.rect_player2.fillColor=this.default_rect_color,this.lab_player2.text="2",this.lab_player2.textColor=7697781,this.btn_kick2.visible=!1),this.img_owner.visible=!1},t.prototype.wipePlayerLocation=function(e,t){this.isOwner=t==GameData.gameUser.id,this.delPlayerList(e);for(var s=0;s<this._playerList.length;s++)this._playerList[s].isOwner=t==this._playerList[s].id,this._playerList[s].tableID=s+1,this.showPlayer(this._playerList[s])},t.prototype.mbuttonStartGameBtn=function(e){this._playerList.length>=GameData.maxPlayerNum?(GameData.playerUserIds=this._playerList,mvs.MsEngine.getInstance.joinOver("joinOver")):console.log("人不够，或者还有人没有准备！")},t.prototype.mbuttonLeaveRoom=function(e){this._isInRoom?mvs.MsEngine.getInstance.leaveRoom("累了困了离开一下"):(this.release(),GameSceneView._gameScene.tobattlelobby())},t.prototype.btnKickPlayerClick=function(e){var t=0;"btn_kick2"==e.target.name?t=2:"btn_kick3"==e.target.name&&(t=3);var s=this.getUserForTableID(t);return null==s?void console.info("用户不存在"):void mvs.MsEngine.getInstance.kickPlayer(s.id,"我们不能一起好好的玩游戏")},t.prototype.getUserForTableID=function(e){var t=null;return this._playerList.forEach(function(s){s.tableID==e&&(t=s)}),t},t.prototype.leaveRoomNotify=function(e){var t=e.data;console.info("玩家离开",t);var s=t.userId;t.owner==GameData.gameUser.id?this.isOwner=!0:this.isOwner=!1,this.delPlayerList(s),this.canStartGame=!1;for(var n=0;n<this._playerList.length;n++)t.owner==this._playerList[n].id?this._playerList[n].isOwner=!0:this._playerList[n].isOwner=!1,this._playerList[n].tableID=n+1,this.showPlayer(this._playerList[n])},t.prototype.leaveRoomResponse=function(e){var t=e.data;200!==t.status?console.log("退出房间失败！status="+t.status):(this.release(),GameSceneView._gameScene.tobattlelobby())},t.prototype.createRoomResponse=function(e){var t=e.data;if(200==t.status){var s=1;t.owner==GameData.gameUser.id?this.isOwner=!0:this.isOwner=!1,this.addPlayerList(GameData.gameUser.id,GameData.gameUser.name,GameData.gameUser.avatar,s,this.isOwner),this.lab_roomID.text="房间号:"+t.roomID,this._roomID=t.roomID,GameData.roomID=t.roomID,this._isInRoom=!0}else console.info("加入房间失败",t)},t.prototype.joinRoomResponse=function(e){var t=e.data;if(200==t.status){this.lab_roomID.text="房间号:"+t.roomInfo.roomID,this._roomID=t.roomInfo.roomID,GameData.roomID=t.roomInfo.roomID,this._isInRoom=!0,GameData.gameUser.isOwner=!1,t.roomInfo.ownerId==GameData.gameUser.id?this.isOwner=!0:this.isOwner=!1;var s=1;this.addPlayerList(GameData.gameUser.id,GameData.gameUser.name,GameData.gameUser.avatar,s,this.isOwner);for(var n=t.userList,o=0;o<n.length;o++)s++,this.otherJoinShowInfo(n[o].userId,s,n[o].userProfile,t.roomInfo.ownerId==n[o].userId);this.checkStart()}else console.info("加入房间失败",t)},t.prototype.checkStart=function(){console.info("房间人数："+this._playerList.length),this._playerList.length==GameData.maxPlayerNum?(console.info("可以开始游戏"),this.canStartGame=!0,this.check_closeRoom.visible=!1,this.joinFlag==t.JOINFLAG.CREATEROOM||this.joinFlag==t.JOINFLAG.WITHROOMID?(this.btn_start.visible=this.isOwner,this.btn_start.enabled=this.isOwner):(this.isOwner,this.btn_start.visible=!1,this.btn_start.enabled=!1)):(this.canStartGame=!1,this.btn_start.enabled=!1,this.check_closeRoom.visible=!0)},t.prototype.otherJoinShowInfo=function(e,t,s,n){if(void 0===n&&(n=!1),s&&""!==s){var o="",a="",i=JSON.parse(s);i.name&&(o=i.name),i.avatar&&(a=i.avatar),this.addPlayerList(e,o,a,t,n)}},t.prototype.joinRoomNotify=function(e){var t=e.data,s=(t.userId,this._playerList.length+1);this.otherJoinShowInfo(t.userId,s,t.userProfile,t.userId==t.owner),this.checkStart()},t.prototype.notifyGameStart=function(){GameData.isRoomOwner=!0;var e=[];this._playerList.forEach(function(t){e.push({id:t.id,name:t.name,avatar:t.avatar})});var t={action:GameData.gameStartEvent,userIds:e},s=mvs.MsEngine.getInstance.sendEvent(JSON.stringify(t));return 0!==s.result?console.log("发送游戏开始通知失败，错误码"+s.result):(GameData.events[s.sequence]=t,void console.log("发起游戏开始的通知，等待回复"))},t.prototype.sendEventResponse=function(e){var t=e.data;if(200!==t.status)return console.log("事件发送失败,status:"+status);var s=GameData.events[t.sequence];s&&s.action===GameData.gameStartEvent&&(delete GameData.events[t.sequence],this.release(),GameSceneView._gameScene.play())},t.prototype.sendEventNotify=function(e){console.log("收到消息",e.data);var t=e.data;t&&t.cpProto&&t.cpProto.indexOf(GameData.gameStartEvent)>=0&&(GameData.playerUserIds=this._playerList,this.release(),GameSceneView._gameScene.play())},t.prototype.joinOverResponse=function(e){var t=e.data;if(200===t.status){if(console.log("关闭房间成功"),this.canStartGame)return this.notifyGameStart(),void(GameData.playerUserIds=this._playerList)}else console.log("关闭房间失败，回调通知错误码：",t.status);Toast.show(" 设置不允许房间加人 "+(200==t.status?"success":"fail")),this.check_closeRoom.selected=200==t.status?!1:this.check_closeRoom.selected},t.prototype.joinOverNotify=function(e){var t=e.data;console.log("userID:"+t.userID+" 关闭房间："+t.roomID+" cpProto:"+t.cpProto),Toast.show(t.userID+" 设置了不允许房间加人"),this.check_closeRoom.selected=!1,this.check_closeRoom.label="禁止加入"},t.prototype.joinOpenResponse=function(e){var t=e.data;Toast.show(" 设置允许房间加人 "+(200==t.status?"success":"fail")),this.check_closeRoom.selected=200==t.status?!0:this.check_closeRoom.selected},t.prototype.joinOpenNotify=function(e){var t=e.data;Toast.show(t.userID+" 设置了允许房间加人"),this.check_closeRoom.selected=!0,this.check_closeRoom.label="允许加入"},t.prototype.cancelStart=function(e,t){this.btn_start.enabled=!1,this.btn_start.visible=this.isOwner,this.canStartGame=!1,this.check_closeRoom.visible=!0},t.prototype.kickPlayerResponse=function(e){var t=e.data;this.cancelStart(t.userID,this._roomID),this.wipePlayerLocation(t.userID,t.owner)},t.prototype.kickPlayerNotify=function(e){var t=e.data;console.info("玩家离开",t),t.userID==GameData.gameUser.id?(this.release(),GameSceneView._gameScene.tobattlelobby()):(this.cancelStart(t.userID,this._roomID),this.wipePlayerLocation(t.userID,t.owner))},t.prototype.networkStateNotify=function(e){var t=e.data,s=t.userID;this.cancelStart(s,t.roomID),(t.state=1)?(console.info("玩家断开:"+s),mvs.MsEngine.getInstance.kickPlayer(s,"玩家断线踢掉")):2==t.state?console.info("玩家正在从新连接..."+s):(console.info("玩家离开"+s),this.wipePlayerLocation(t.userID,t.owner))},t.prototype.setRoomPropertyResponse=function(e){console.log("roomProperty = "+e.data.roomProperty)},t.JOINFLAG={RANDROOM:1,CREATEROOM:2,WITHROOMID:3,WITHPROPERTY:4},t}(eui.Component);__reflect(bat_match.prototype,"bat_match",["eui.UIComponent","egret.DisplayObject"]);var Main=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(s){switch(s.label){case 0:return[4,this.loadResource()];case 1:return s.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return e=s.sent(),[4,platform.login()];case 3:return s.sent(),[4,platform.getUserInfo()];case 4:return t=s.sent(),console.log(t),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(s){switch(s.label){case 0:return s.trys.push([0,5,,6]),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return s.sent(),e=new LoadingUI,[4,RES.loadGroup("loading")];case 2:return s.sent(),this.stage.addChild(e),[4,this.loadTheme()];case 3:return s.sent(),[4,RES.loadGroup("preload",0,e)];case 4:return s.sent(),this.stage.removeChild(e),[3,6];case 5:return t=s.sent(),console.error(t),[3,6];case 6:return[2]}})})},t.prototype.loadTheme=function(){var e=this;return new Promise(function(t,s){var n=new eui.Theme("resource/default.thm.json",e.stage);n.addEventListener(eui.UIEvent.COMPLETE,function(){t()},e)})},t.prototype.createGameScene=function(){this._scene=new GameSceneView,this._scene.graphics.beginFill(0),this._scene.graphics.drawRect(this.x,this.y,this.width,this.height),this._scene.graphics.endFill(),this.addChild(this._scene)},t}(eui.UILayer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,s,n){function o(e){t.call(n,e)}function a(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),s.call(n))}var i=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){t.call(n,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(e,s){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(n,generateEUI2)},i)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(e.indexOf(".exml")>-1){var r=e.split("/");r.pop();var h=r.join("/")+"_EUI.json";generateJSON.paths[e]?egret.callLater(function(){t.call(n,generateJSON.paths[e])},this):RES.getResByUrl(h,function(s){window.JSONParseClass.setData(s),egret.callLater(function(){t.call(n,generateJSON.paths[e])},i)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){t.call(n,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),RES.getResByUrl(e,o,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var GameData=function(){function e(){}return e.init=function(){this.isGameOver=!0,this.isRoomOwner=!1,this.syncFrame=!1,this.number1="",this.number2="",this.roomID="",this.intervalList=[],this.playerUserIds=[]},e.configEnvir=function(t,s){e.CHANNEL=t,e.DEFAULT_ENV=s?e.ENVIRONMENT.dev:e.ENVIRONMENT.pro,"MatchVS"===t&&(e.gameID=201150,e.appkey="0db8550d9bd345da82b852564f59d2e6",e.secretKey="15bf7e1bc2454d21b071d67f568e257c"),"MatchVS-Test"===t&&(e.gameID=201170,e.appkey="a5b937f29a4c480bb6946093105c0565",e.secretKey="a8c5c84afde44136a5eea6f0ac09887c"),"MatchVS-Test1"===t&&(e.gameID=201078,e.appkey="938e1ee0db444a079fe0695598677ba0",e.secretKey="9b11e0eca09141a1961d49d6b6028075")},e.getBindOpenIDAddr=function(e,t){if("MatchVS"==e||"Matchvs"==e){if("release"==t)return"http://vsuser.matchvs.com/wc6/thirdBind.do?";if("alpha"==t)return"http://alphavsuser.matchvs.com/wc6/thirdBind.do?"}else if("MatchVS-Test1"==e){if("release"==t)return"http://zwuser.matchvs.com/wc6/thirdBind.do?";if("alpha"==t)return"http://alphazwuser.matchvs.com/wc6/thirdBind.do?"}},e.getSign=function(t){var s=e.appkey+"&"+t+"&"+e.secretKey;console.info("待签名："+s);var n=(new MD5).hex_md5(s);return n},e.CHANNEL="MatchVS",e.DEFAULT_ENV="alpha",e.ENVIRONMENT={dev:"alpha",pro:"release"},e.gameID=215927,e.appkey="737202d460014c5ea5ec78c67a53a822#E",e.secretKey="c423ff05b5b841478dcafd9d33072f7e",e.gameUser=new GameUser,e.playerUserIds=[],e.matchType=0,e.randomMatch=1,e.specialMatch=2,e.tagsMatch=3,e.maxPlayerNum=2,e.isRoomOwner=!1,e.gameStartEvent="gameStart",e.playerPositionEvent="playerPosition",e.reconnectStartEvent="gameReconnectStart",e.newStarEvent="newStar",e.changeStarEvent="changeStar",e.changeTurnEvent="changeTurnEvent",e.gameReadyEvent="gameReady",e.reconnectReadyEvent="gameReconnectReady",e.events={},e.syncFrame=!1,e.isGameOver=!1,e.my_hp_max=0,e.my_hp_now=0,e.my_hp=792,e.emy_hp_max=0,e.emy_hp_now=0,e.emy_hp=582,e.emy_head="",e.my_cost=6,e.Stable=!1,e.but=0,e.frameRate=5,e.defaultHeight=400,e.roomID="",e.intervalList=[],e.number1="",e.number2="",e.playerTime=0,e.createRoomInfo=new MsCreateRoomInfo("MatchvsDemoEgret",2,0,0,1),e}();__reflect(GameData.prototype,"GameData");var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,s){function n(n){t.call(s,n,e)}if(RES.hasRes(e)){var o=RES.getRes(e);o?n(o):RES.getResAsync(e,n,this)}else RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var error_note=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.partAdded=function(t,s){e.prototype.partAdded.call(this,t,s),"btn_return"==t?(this.btn_return=s,this.btn_return.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mbuttonExitRoom,this)):"lab_content"==t?this.lab_content=s:"btn_reconnect"==t&&(this.btn_reconnect=s,this.btn_reconnect.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mbuttonReconnRoom,this))},t.prototype.childrenCreated=function(){for(e.prototype.childrenCreated.call(this),this.lab_userID.text="用户ID："+GameData.gameUser.id;GameData.intervalList.length>0;)clearTimeout(GameData.intervalList.pop());this.lab_content.text=this.errMsg},t.prototype.SetErrorMsg=function(e){this.errMsg=e},t.prototype.showReconnect=function(){this.btn_reconnect.visible=!0},t.prototype.mbuttonReconnRoom=function(e){GameSceneView._gameScene.reconnectView()},t.prototype.mbuttonExitRoom=function(e){GameSceneView._gameScene.tobattle_login()},t}(eui.Component);__reflect(error_note.prototype,"error_note",["eui.UIComponent","egret.DisplayObject"]);var GameSceneView=function(e){function t(){var s=e.call(this)||this;return t._gameScene=s,s.initView(),s}return __extends(t,e),t.errorResponse=function(e,s){console.log("错误回调：errCode="+e+" errMsg="+s),t._gameScene.errorView(0,"错误回调：errCode="+e+" errMsg="+s)},t.prototype.errorResponses=function(e){var s=e.data.errCode,n=e.data.errMsg;1001==s&&(""!=n&&n.indexOf("hotel")>=0?t._gameScene.errorView(1,"错误回调：errCode="+s+" errMsg="+n):t._gameScene.errorView(0,"错误回调：errCode="+s+" errMsg="+n))},t.prototype.initView=function(){mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_ERROR_RSP,this.errorResponses,this),this.thisContainer=new egret.Sprite,this.addChild(this.thisContainer),this.tohome()},t.prototype.tohome=function(){this.removeAll();var e=new home;this.thisContainer.addChild(e)},t.prototype.tobattleScene=function(){this.removeAll();var e=new battlesense;this.thisContainer.addChild(e)},t.prototype.toHeroScene=function(){this.removeAll();var e=new herosense;this.thisContainer.addChild(e)},t.prototype.toShopSene=function(){this.removeAll();var e=new shopsene;this.thisContainer.addChild(e)},t.prototype.toAboutSene=function(){this.removeAll();var e=new aboutsene;this.thisContainer.addChild(e)},t.prototype.tobattlechoose=function(){this.removeAll();var e=new battlechoose;this.thisContainer.addChild(e)},t.prototype.tobattle_login=function(){this.removeAll();var e=new battle_login;this.thisContainer.addChild(e)},t.prototype.tobattlelobby=function(){this.removeAll();var e=new battle_lobby;this.thisContainer.addChild(e)},t.prototype.toE1sense=function(){this.removeAll();var e=new E1sense;this.thisContainer.addChild(e)},t.prototype.tocksense=function(){this.removeAll();var e=new CKsense;this.thisContainer.addChild(e)},t.prototype.showResult=function(e,t){this.removeAll();var s=new game_results;s.setResult(e,t),this.thisContainer.addChild(s)},t.prototype.tobatmatch=function(e,t){this.removeAll();var s=new bat_match;s.setJoinParame(e,t),this.thisContainer.addChild(s)},t.prototype.tosalesense=function(){this.removeAll();var e=new salesense;this.thisContainer.addChild(e)},t.prototype.play=function(){this.removeAll();var e=new PVPBattle;this.cuntPage=e,this.thisContainer.addChild(e)},t.prototype.showRoomList=function(){this.removeAll();var e=new RoomListUI;this.thisContainer.addChild(e)},t.prototype.joinRoomSpecial=function(){this.removeAll();var e=new matchroom;this.thisContainer.addChild(e)},t.prototype.createRoom=function(e,t){this.removeAll();var s=new bat_match;s.setJoinParame(bat_match.JOINFLAG.CREATEROOM),this.thisContainer.addChild(s)},t.prototype.reconnectView=function(){this.removeAll();var e=new ReconnectUI;this.thisContainer.addChild(e)},t.prototype.errorView=function(e,t){this.removeAll(),GameData.init();var s=new error_note;s.SetErrorMsg(t),this.thisContainer.addChild(s)},t.prototype.removeAll=function(){this.cuntPage&&this.cuntPage.release&&(console.log("释放"),this.cuntPage.release(),this.cuntPage=null),this.thisContainer.removeChildren()},t}(egret.Sprite);__reflect(GameSceneView.prototype,"GameSceneView");var messagerManager=function(){function e(){this.home=new home,this.shopsene=new shopsene,this.aboutScene=new aboutsene,this.herosense=new herosense,this.battlesense=new battlesense,this.E1sense=new E1sense}return Object.defineProperty(e,"instance",{get:function(){return this.sceneManager||(this.sceneManager=new SceneManager),this.sceneManager},enumerable:!0,configurable:!0}),e.prototype.setStage=function(e){this._stage=e},e.showInfo=function(e){var t="你选择了: ";0===e.length?t="厉害了什么都不选":t+=e.toString();var s=new egret.Bitmap;s.texture=RES.getRes("toast-bg_png"),s.x=SceneManager.instance.shopsene.width/2-s.width/2,s.y=500,s.height=40;var n=new egret.TextField;n.text=t,n.size=20,SceneManager.instance.shopsene.addChild(n),n.x=SceneManager.instance.shopsene.width/2-n.width/2,n.y=510,n.height=40;var o=new egret.Timer(3e3,1);o.start(),o.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(e){SceneManager.instance.shopsene.removeChild(n),SceneManager.instance.shopsene.removeChild(s)},this)},e.showfaildinE1=function(e){var t=e,s=new egret.Bitmap;s.texture=RES.getRes("toast-bg_png"),SceneManager.instance.E1sense.addChild(s),s.x=SceneManager.instance.E1sense.width/2-s.width/2,s.y=500,s.height=40;var n=new egret.TextField;n.text=t,n.size=20,SceneManager.instance.E1sense.addChild(n),n.x=SceneManager.instance.E1sense.width/2-n.width/2,n.y=510,n.height=40;var o=new egret.Timer(2e3,1);o.start(),o.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(e){SceneManager.instance.E1sense.removeChild(n),SceneManager.instance.E1sense.removeChild(s)},this)},e.showfaildinshop=function(e){var t=e,s=new egret.Bitmap;s.texture=RES.getRes("toast-bg_png"),SceneManager.instance.shopsene.addChild(s),s.x=SceneManager.instance.shopsene.width/2-s.width/2,s.y=500,s.height=40;var n=new egret.TextField;n.text=t,n.size=20,SceneManager.instance.shopsene.addChild(n),n.x=SceneManager.instance.shopsene.width/2-n.width/2,n.y=510,n.height=40;var o=new egret.Timer(2e3,1);o.start(),o.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(e){SceneManager.instance.shopsene.removeChild(n),SceneManager.instance.shopsene.removeChild(s)},this)},e.showfaildinbat=function(e){var t=e,s=new egret.Bitmap;s.texture=RES.getRes("toast-bg_png"),SceneManager.instance.battlesense.addChild(s),s.x=SceneManager.instance.battlesense.width/2-s.width/2,s.y=500,s.height=40;var n=new egret.TextField;n.text=t,n.size=20,SceneManager.instance.battlesense.addChild(n),n.x=SceneManager.instance.battlesense.width/2-n.width/2,n.y=510,n.height=40;var o=new egret.Timer(2e3,1);o.start(),o.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(e){SceneManager.instance.battlesense.removeChild(n),SceneManager.instance.battlesense.removeChild(s)},this)},e}();__reflect(messagerManager.prototype,"messagerManager");var SceneManager=function(){function e(){this.home=new home,this.shopsene=new shopsene,this.aboutScene=new aboutsene,this.herosense=new herosense,this.battlesense=new battlesense,this.E1sense=new E1sense,this.battlechoose=new battlechoose,this.battle_login=new battle_login,this.battle_lobby=new battle_lobby,this.bat_match=new bat_match}return Object.defineProperty(e,"instance",{get:function(){return this.sceneManager||(this.sceneManager=new e),this.sceneManager},enumerable:!0,configurable:!0}),e.prototype.setStage=function(e){this._stage=e},e.prototype.removeOther=function(e){var t=this,s=[this.home,this.aboutScene,this.shopsene,this.herosense,this.battlesense,this.E1sense,this.battlechoose,this.battle_login,this.battle_lobby,this.bat_match];s.forEach(function(s){e!=s&&s.parent&&(t.home.removeChild(s),console.log("删除成功"))})},e.showInfo=function(t){var s="你选择了: ";0===t.length?s="厉害了什么都不选":s+=t.toString();var n=new egret.Bitmap;n.texture=RES.getRes("toast-bg_png"),e.instance.shopsene.addChild(n),n.x=e.instance.shopsene.width/2-n.width/2,n.y=500,n.height=40;var o=new egret.TextField;o.text=s,o.size=20,e.instance.shopsene.addChild(o),o.x=e.instance.shopsene.width/2-o.width/2,o.y=510,o.height=40;var a=new egret.Timer(3e3,1);a.start(),a.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(t){e.instance.shopsene.removeChild(o),e.instance.shopsene.removeChild(n)},this)},e.tohome=function(){var t=this.instance._stage,s=e.instance.home;this.instance.removeOther(this.instance.home),s.parent||t.addChild(s)},e.tobattleScene=function(){this.instance.home.addChild(this.instance.battlesense)},e.toHeroScene=function(){console.log("arrived shopsene"),this.instance.home.addChild(this.instance.herosense)},e.toShopSene=function(){console.log("arrived shopsene"),this.instance.home.addChild(this.instance.shopsene)},e.toAboutSene=function(){console.log("arrived aboutsene"),this.instance.home.addChild(this.instance.aboutScene)},e.tobattlechoose=function(){console.log("arrived aboutsene"),this.instance.home.addChild(this.instance.battlechoose)},e.tobattle_login=function(){console.log("battle_login aboutsene"),this.instance.home.addChild(this.instance.battle_login)},e.tobattlelobby=function(){this.instance.home.addChild(this.instance.battle_lobby)},e.toE1sense=function(){console.log("arrived aboutsene"),this.instance.home.addChild(this.instance.E1sense)},e.prototype.removeAll=function(){this.cuntPage&&this.cuntPage.release&&(console.log("释放"),this.cuntPage.release(),this.cuntPage=null),this.thisContainer.removeChildren()},e}();__reflect(SceneManager.prototype,"SceneManager");var shoplist_item=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/skin_items/herolist.exml",t.addEventListener(eui.UIEvent.CREATION_COMPLETE,t.onComplete,t),t
}return __extends(t,e),t.prototype.onComplete=function(){var e=this;this.hero_sel.addEventListener(eui.UIEvent.CHANGE,function(t){e.data.isSelected=e.hero_sel.selected},this)},t.prototype.dataChanged=function(){this.hero_sel.selected=this.data.isSelected},t}(eui.ItemRenderer);__reflect(shoplist_item.prototype,"shoplist_item");var ArrayTools=function(){function e(){}return e.RandomSort=function(e){e.sort(function(){return Math.random()-.5})},e.Sort=function(e){e.sort(function(e,t){return e-t})},e.UTF16ToUTF8=function(e){for(var t=[],s=e.length,n=0;s>n;n++){var o=e.charCodeAt(n);if(o>0&&127>=o)t.push(e.charAt(n));else if(o>=128&&2047>=o){var a=192|o>>6&31,i=128|63&o;t.push(String.fromCharCode(a),String.fromCharCode(i))}else if(o>=2048&&65535>=o){var a=224|o>>12&15,i=128|o>>6&63,r=128|63&o;t.push(String.fromCharCode(a),String.fromCharCode(i),String.fromCharCode(r))}}return t.join("")},e.UTF8ToUTF16=function(e){for(var t=[],s=e.length,n=0,n=0;s>n;n++){var o=e.charCodeAt(n);if(0==(o>>7&255))t.push(e.charAt(n));else if(6==(o>>5&255)){var a=e.charCodeAt(++n),i=(31&o)<<6,r=63&a,h=i|r;t.push(String.fromCharCode(h))}else if(14==(o>>4&255)){var a=e.charCodeAt(++n),c=e.charCodeAt(++n),i=o<<4|a>>2&15,r=(3&a)<<6|63&c,h=(255&i)<<8|r;t.push(String.fromCharCode(h))}}return t.join("")},e.Base64Encode=function(e){if(!e)return"";for(var t=this.UTF16ToUTF8(e),s=0,n=t.length,o=[];n>s;){var a=255&t.charCodeAt(s++);if(o.push(this.table[a>>2]),s==n){o.push(this.table[(3&a)<<4]),o.push("==");break}var i=t.charCodeAt(s++);if(s==n){o.push(this.table[(3&a)<<4|i>>4&15]),o.push(this.table[(15&i)<<2]),o.push("=");break}var r=t.charCodeAt(s++);o.push(this.table[(3&a)<<4|i>>4&15]),o.push(this.table[(15&i)<<2|(192&r)>>6]),o.push(this.table[63&r])}return o.join("")},e.Base64Decode=function(e){if(!e)return"";for(var t=e.length,s=0,n=[],o=0,a=0,i=0,r=0;t>s;){o=this.table.indexOf(e.charAt(s++)),a=this.table.indexOf(e.charAt(s++)),i=this.table.indexOf(e.charAt(s++)),r=this.table.indexOf(e.charAt(s++));var h=o<<2|a>>4;if(n.push(String.fromCharCode(h)),-1!=i){var c=(15&a)<<4|i>>2;n.push(String.fromCharCode(c))}if(-1!=r){var l=(3&i)<<6|r;n.push(String.fromCharCode(l))}}return this.UTF8ToUTF16(n.join(""))},e.table=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],e}();__reflect(ArrayTools.prototype,"ArrayTools");var mvs;!function(e){var t=function(){function t(){this._engine=null,this._response=null,this._engine=new MatchvsEngine}return Object.defineProperty(t,"getInstance",{get:function(){return null==t._instance&&(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.prototype.init=function(t,s,n,o){this._response=e.MsResponse.getInstance.getResponse();var a=this._engine.init(e.MsResponse.getInstance.getResponse(),t,s,n,o,1);return 200!==a?(console.info("[MsEngine init failed] resCode:",a),a):(console.info("[MsEngine init seccess] resCode:",a),a)},t.prototype.premiseInit=function(t,s,n){this._response=e.MsResponse.getInstance.getResponse();var o=this._engine.premiseInit(e.MsResponse.getInstance.getResponse(),t,s,n);return 0!==o?(console.info("[MsEngine premiseInit failed] resCode:",o),o):(console.info("[MsEngine premiseInit seccess] resCode:",o),o)},t.prototype.login=function(e,t){var s=this._engine.login(e,t,"eglejjddg");return console.info("[MsEngine login] resCode:",s),s},t.prototype.registerUser=function(){var e=this._engine.registerUser();return 0!==e?(console.error("[MsEngine registerUser failed] resCode:",e),e):(console.info("[MsEngine registerUser seccess] resCode:",e),e)},t.prototype.joinRandomRoom=function(e,t){var s=this._engine.joinRandomRoom(e,t);return console.info("[MsEngine joinRandomRoom ] resCode:",s),s},t.prototype.joinRoomWithProperties=function(e,t){var s=this._engine.joinRoomWithProperties(e,t);return console.info("[MsEngine joinRandomRoom ] resCode:",s),s},t.prototype.joinRoom=function(e,t){var s=this._engine.joinRoom(e,t);return console.info("[MsEngine joinRoom ] resCode:",s),s},t.prototype.createRoom=function(e,t){var s=this._engine.createRoom(e,t);return console.info("[MsEngine createRoom ] resCode:",s,JSON.stringify(e),t),s},t.prototype.joinOver=function(e){var t=this._engine.joinOver(e);return console.info("[MsEngine joinOver ] resCode:",t),t},t.prototype.joinOpen=function(e){var t=this._engine.joinOpen(e);return console.info("[MsEngine joinOpen ] resCode:",t),t},t.prototype.leaveRoom=function(e){var t=this._engine.leaveRoom(e);return console.info("[MsEngine leaveRoom ] resCode:",t),t},t.prototype.sendEvent=function(e){var t=this._engine.sendEvent(e);return t},t.prototype.sendEventEx=function(e,t,s,n){var o=this._engine.sendEventEx(e,t,s,n);return o},t.prototype.sendFrameEvent=function(e){var t=this._engine.sendFrameEvent(e,0);return console.info("[MsEngine sendFrameEvent ] resCode:",t),t},t.prototype.setFrameSync=function(e){var t=this._engine.setFrameSync(e);return console.info("[MsEngine setFrameSync ] resCode:",t),t},t.prototype.logOut=function(){var e=this._engine.logout("退出登录");return console.info("[MsEngine setFrameSync ] resCode:",e),e},t.prototype.kickPlayer=function(e,t){var s=this._engine.kickPlayer(e,t);return console.info("[MsEngine kickPlayer ] resCode:",s),s},t.prototype.getRoomDetail=function(e){var t=this._engine.getRoomDetail(e);return console.info("[MsEngine getRoomDetail ] resCode:",t),t},t.prototype.getRoomList=function(e){var t=this._engine.getRoomList(e);return console.info("[MsEngine getRoomList ] resCode:",t),t},t.prototype.getRoomListEx=function(e){var t=this._engine.getRoomListEx(e);return console.info("[MsEngine getRoomListEx ] resCode:",t),t},t.prototype.setRoomProperty=function(e,t){var s=this._engine.setRoomProperty(e,t);return console.info("[MsEngine setRoomProperty ] resCode:",s),s},t.prototype.reconnect=function(){var e=this._engine.reconnect();return console.info("[MsEngine reconnect ]",e),e},t._instance=null,t}();e.MsEngine=t,__reflect(t.prototype,"mvs.MsEngine")}(mvs||(mvs={}));var mvs;!function(e){var t=function(){function e(){}return e.EVENT_INIT_RSP="MATCHVS_INIT_EVENT",e.EVENT_REGISTERUSER_RSP="MATCHVS_REGISTERUSER_EVENT",e.EVENT_LOGIN_RSP="MATCHVS_LOGIN_EVENT",e.EVENT_JOINROOM_RSP="MATCHVS_JOINROOM_EVENT",e.EVENT_JOINROOM_NTFY="MATCHVS_JOINROOM_NOTIFY_EVENT",e.EVENT_CREATEROOM_RSP="MATCHVS_CREATEROOM_RSP_EVENT",e.EVENT_SENDEVENT_RSP="MATCHVS_SENDEVENT_RSP_EVENT",e.EVENT_SENDEVENT_NTFY="MATCHVS_SENDEVENT_NOTIFY_EVENT",e.EVENT_GAMESERVER_NTFY="MATCHVS_GAMESERVER_NOTIFY_EVENT",e.EVENT_LEAVEROOM_RSP="MATCHVS_LEAVEROOM_RSP_EVENT",e.EVENT_LEAVEROOM_NTFY="MATCHVS_LEAVEROOM_NTFY_EVENT",e.EVENT_JOINOVER_RSP="MATCHVS_JOINOVER_RSP_EVENT",e.EVENT_JOINOVER_NTFY="MATCHVS_LEAVEROOM_EVENT",e.EVENT_JOINOPEN_RSP="MATCHVS_JOINOPEN_RSP_EVENT",e.EVENT_JOINOPEN_NTFY="MATCHVS_JOINOPEN_NTFY_EVENT",e.EVENT_NETWORKSTATE_NTFY="MATCHVS_NETWORKSTATE_NTFY",e.EVENT_SENDFRAME_RSP="MATCHVS_SENDFRAME_RSP_EVENT",e.EVENT_SETFRAMESYNC_RSP="MATCHVS_SETFRAMESYNC_RSP_EVENT",e.EVENT_FRAMEUPDATE="MATCHVS_FRAMEUPDATE_EVENT",e.EVENT_ERROR_RSP="MATCHVS_ERROR_RSP_EVENT",e.EVENT_LOGOUT_RSP="MATCHVS_LOGOUT_RSP_EVENT",e.EVENT_SETROOMPROPERTY_RSP="MATCHVS_SETROOMPROPERTY_RSP_EVENT",e.EVENT_SETROOMPROPERTY_NTFY="MATCHVS_SETROOMPROPERTY_NTFY_EVENT",e.EVENT_KICKPLAYER_RSP="MATCHVS_KICKPLAYER_RSP_EVENT",e.EVENT_KICKPLAYER_NTFY="MATCHVS_KICKPLAYER_NTFY_EVENT",e.EVENT_GETROOMLIST_RSP="MATCHVS_GETROOMLIST_RSP_EVENT",e.EVENT_GETROOMLIST_EX_RSP="MATCHVS_GETROOMLIST_EX_RSP_EVENT",e.EVENT_GETROOMDETAIL_RSP="MATCHVS_GETROOMDETAIL_RSP_EVENT",e.EVENT_RECONNECT_RSP="MATCHVS_RECONNECT_RSP_EVENT",e}();e.MsEvent=t,__reflect(t.prototype,"mvs.MsEvent")}(mvs||(mvs={}));var mvs;!function(e){var t=function(t){function s(){var e=t.call(this)||this;return e.reframe=[],e.startTime=0,e.endTime=0,e.frist=0,e.re100=0,e.re70=0,e.re200=0,e.re60=0,e.re40=0,e._response=null,e.registResponseCall(),e}return __extends(s,t),Object.defineProperty(s,"getInstance",{get:function(){return null==s._instance&&(s._instance=new s),s._instance},enumerable:!0,configurable:!0}),s.release=function(){s._instance._response=null,s._instance=null},s.prototype.getResponse=function(){return null==this._response&&this.registResponseCall(),this._response},s.prototype.registResponseCall=function(){this._response=new MatchvsResponse,this._response.initResponse=this.initResponse.bind(this),this._response.registerUserResponse=this.registerUserResponse.bind(this),this._response.loginResponse=this.loginResponse.bind(this),this._response.joinRoomResponse=this.joinRoomResponse.bind(this),this._response.joinRoomNotify=this.joinRoomNotify.bind(this),this._response.createRoomResponse=this.createRoomResponse.bind(this),this._response.sendEventResponse=this.sendEventResponse.bind(this),this._response.sendEventNotify=this.sendEventNotify.bind(this),this._response.gameServerNotify=this.gameServerNotify.bind(this),this._response.joinOverResponse=this.joinOverResponse.bind(this),this._response.joinOverNotify=this.joinOverNotify.bind(this),this._response.leaveRoomResponse=this.leaveRoomResponse.bind(this),this._response.leaveRoomNotify=this.leaveRoomNotify.bind(this),this._response.networkStateNotify=this.networkStateNotify.bind(this),this._response.setFrameSyncResponse=this.setFrameSyncResponse.bind(this),this._response.frameUpdate=this.frameUpdate.bind(this),this._response.errorResponse=this.errorResponse.bind(this),this._response.logoutResponse=this.logOutResponse.bind(this),this._response.joinOpenResponse=this.joinOpenResponse.bind(this),this._response.joinOpenNotify=this.joinOpenNotify.bind(this),this._response.kickPlayerNotify=this.kickPlayerNotify.bind(this),this._response.kickPlayerResponse=this.kickPlayerResponse.bind(this),this._response.setRoomPropertyNotify=this.setRoomPropertyNotify.bind(this),this._response.setRoomPropertyResponse=this.setRoomPropertyResponse.bind(this),this._response.getRoomDetailResponse=this.getRoomDetailResponse.bind(this),this._response.getRoomListExResponse=this.getRoomListExResponse.bind(this),this._response.getRoomListResponse=this.getRoomListResponse.bind(this),this._response.reconnectResponse=this.reconnectResponse.bind(this)},s.prototype.initResponse=function(t){console.info("initResponse status：",t),this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_INIT_RSP,!1,!1,{status:t}))},s.prototype.registerUserResponse=function(t){console.info("registerUserResponse userInfo ",JSON.stringify(t)),this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_REGISTERUSER_RSP,!1,!1,t))},s.prototype.loginResponse=function(t){console.info("[loginResponse] "+JSON.stringify(t)),this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_LOGIN_RSP,!1,!1,t))},s.prototype.joinRoomResponse=function(t,s,n){if(200==t){var o={status:t,userList:s,roomInfo:n};return void this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_JOINROOM_RSP,!1,!1,o))}console.error("[joinRoomResponse error:]",t)},s.prototype.joinRoomNotify=function(t){console.info("[joinRoomNotify] "+t.userProfile);var s={userId:t.userId,userProfile:t.userProfile};this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_JOINROOM_NTFY,!1,!1,s))},s.prototype.createRoomResponse=function(t){console.info("[sendEventResponse]"+JSON.stringify(t));var s={status:t.status,roomID:t.roomID,owner:t.owner};this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_CREATEROOM_RSP,!1,!1,s))},s.prototype.sendEventResponse=function(t){var s={status:t.status,sequence:t.sequence};this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_SENDEVENT_RSP,!1,!1,s))},s.prototype.sendEventNotify=function(t){var s={srcUserId:t.srcUserId,cpProto:t.cpProto};this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_SENDEVENT_NTFY,!1,!1,s))},s.prototype.gameServerNotify=function(t){console.info("[gameServerNotify] ");var s={srcUserId:t.srcUserId,cpProto:t.cpProto};this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_GAMESERVER_NTFY,!1,!1,s))},s.prototype.joinOverResponse=function(t){console.info("[joinOverResponse] "+JSON.stringify(t));var s={status:t.status,cpProto:t.cpProto};this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_JOINOVER_RSP,!1,!1,s))},s.prototype.joinOverNotify=function(t){console.info("[joinOverNotify] ");var s={roomID:t.roomID,userID:t.srcUserID,cpProto:t.cpProto};this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_JOINOVER_NTFY,!1,!1,s))},s.prototype.leaveRoomResponse=function(t){console.info("[leaveRoomResponse] status: "+t.status);var s={roomID:t.roomID,status:t.status,userId:t.userId,cpProto:t.cpProto};this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_LEAVEROOM_RSP,!1,!1,s))},s.prototype.leaveRoomNotify=function(t){console.info("[leaveRoomNotify] "+t.userId);var s={roomID:t.roomID,userId:t.userId,owner:t.owner,cpProto:t.cpProto};this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_LEAVEROOM_NTFY,!1,!1,s))},s.prototype.networkStateNotify=function(t){console.info("[networkStateNotify] state: "+t.state);var s={roomID:t.roomID,userID:t.userID,owner:t.owner,state:t.state};this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_NETWORKSTATE_NTFY,!1,!1,s))},s.prototype.setFrameSyncResponse=function(t){var s={mStatus:t.status};this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_SETFRAMESYNC_RSP,!1,!1,s))},s.prototype.frameUpdate=function(t){var s={frameIndex:t.frameIndex,frameItems:t.frameItems,frameWaitCount:t.frameWaitCount};this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_FRAMEUPDATE,!1,!1,s))},s.prototype.errorResponse=function(t,s){console.info("[setFrameSyncResponse] errCode:"+t+" errMsg:"+s);var n={errCode:t,errMsg:s};this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_ERROR_RSP,!1,!1,n))},s.prototype.logOutResponse=function(t){console.info("[logOutResponse] status:",t);var s={status:t};this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_LOGOUT_RSP,!1,!1,s))},s.prototype.joinOpenResponse=function(t){console.info("[joinOpenResponse] info:",t.status);var s={status:t.status,cpProto:t.cpProto};this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_JOINOPEN_RSP,!1,!1,s))},s.prototype.joinOpenNotify=function(t){console.info("[joinOpenResponse] info:");var s={roomID:t.roomID,userID:t.userID,cpProto:t.cpProto};this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_JOINOPEN_NTFY,!1,!1,s))},s.prototype.kickPlayerNotify=function(t){console.info("[kickPlayerNotify] info:");var s={cpProto:t.cpProto,owner:t.owner,srcUserId:t.srcUserId,userID:t.userID};this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_KICKPLAYER_NTFY,!1,!1,s))},s.prototype.kickPlayerResponse=function(t){console.info("[kickPlayerResponse] info:"+t.status);var s={owner:t.owner,userID:t.userID,status:t.status};this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_KICKPLAYER_RSP,!1,!1,s))},s.prototype.setRoomPropertyNotify=function(t){console.info("[setRoomPropertyNotify] info:");var s={roomID:t.roomID,userID:t.userID,roomProperty:t.roomProperty};this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_SETROOMPROPERTY_NTFY,!1,!1,s))},s.prototype.setRoomPropertyResponse=function(t){console.info("[setRoomPropertyResponse] info:",t.status);var s={roomID:t.roomID,userID:t.userID,roomProperty:t.roomProperty,status:t.status};this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_SETROOMPROPERTY_RSP,!1,!1,s))},s.prototype.getRoomDetailResponse=function(t){console.info("[getRoomDetailResponse] info:",t.status);var s={canWatch:t.canWatch,createFlag:t.createFlag,maxPlayer:t.maxPlayer,mode:t.mode,owner:t.owner,roomProperty:t.roomProperty,state:t.state,status:t.status,userInfos:t.userInfos};this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_GETROOMDETAIL_RSP,!1,!1,s))},s.prototype.getRoomListExResponse=function(t){console.info("[getRoomListExResponse] info:",t.status);var s={roomAttrs:t.roomAttrs,status:t.status,total:t.total};this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_GETROOMLIST_EX_RSP,!1,!1,s))},s.prototype.getRoomListResponse=function(t,s){console.info("[getRoomListResponse] info:",t);var n={status:t,roomInfos:s};this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_GETROOMLIST_RSP,!1,!1,n))},s.prototype.reconnectResponse=function(t,s,n){console.info("[reconnectResponse] info:",t);var o={status:t,roomUserInfoList:s,roomInfo:n};this.dispatchEvent(new egret.Event(e.MsEvent.EVENT_RECONNECT_RSP,!1,!1,o))},s.prototype.frameUpdatequality=function(){var e=(new Date).valueOf();if(0==this.startTime?(this.startTime=e,this.frist=e):this.endTime=e,this.endTime-this.startTime>=5e5){for(var t=0,s=0;s<this.reframe.length;s++)t+=this.reframe[s];console.log("收到总次数：",this.reframe.length),console.log("发送间隔时间：",40),console.log("设置的帧率：",GameData.frameRate),console.log("总耗时：",this.endTime-this.startTime),console.log("预计收到间隔时间：",1e3/GameData.frameRate),console.log("平均收到间隔时间：",t/this.reframe.length),console.log("正常次数：",this.re60),console.log("小于 40 次数：",this.re40),console.log("60 ~ 100 次数：",this.re70),console.log("100 ~ 200 次数：",this.re100),console.log("大于 200 次数：",this.re200)}else{var n=e-this.frist;console.log("收到帧间隔时间：",n),0!==this.frist&&this.reframe.push(n),n>=40&&60>=n?this.re60++:40>n?this.re40++:n>60&&100>n?this.re70++:n>100&&200>n?this.re100++:n>200&&this.re200++}this.frist=e},s._instance=null,s}(egret.EventDispatcher);e.MsResponse=t,__reflect(t.prototype,"mvs.MsResponse")}(mvs||(mvs={}));var MvsHttpApi=function(){function e(){this.open_host="release"==GameData.DEFAULT_ENV?"https://vsopen.matchvs.com":"https://alphavsopen.matchvs.com",this.user_host="release"==GameData.DEFAULT_ENV?"https://vsuser.matchvs.com":"https://alphavsuser.matchvs.com",this.rank_list="/rank/ranking_list?",this.rank_user="/rank/grades?",this.get_game_data="/wc5/getGameData.do?",this.set_game_data="/wc5/setGameData.do?",this.del_game_data="/wc5/delGameData.do?",this.set_user_data="/wc5/setUserData.do?",this.get_user_data="/wc5/getUserData.do?",this.del_user_data="/wc5/delUserData.do?",this.hase_set="/wc5/hashSet.do?",this.hash_get="/wc5/hashGet.do?",this.third_bind="/wc6/thirdBind.do?",this.counter=Math.floor(1e3*Math.random()),this.token=GameData.gameUser.token,this.gameID=GameData.gameID,this.userID=GameData.gameUser.id,this.appkey=GameData.appkey,this.secret=GameData.secretKey}return e.paramsParse=function(e){var t="";for(var s in e){var n="";n="object"==typeof e[s]?JSON.stringify(e[s]):e[s],t=""==t?s+"="+n:t+"&"+s+"="+n}return t},e.url_Join=function(e){for(var t=[],s=1;s<arguments.length;s++)t[s-1]=arguments[s];var n="";return t.forEach(function(e){if("object"==typeof e)throw"the parameter can only be string ";"/"==e.substring(0,1)?n+=e:n=n+"/"+e}),n="/"==e.substring(e.length-1,e.length)?e.substring(0,e.length-1)+n:e+n},e.prototype.getTimeStamp=function(){return Math.floor(Date.now()/1e3)},e.prototype.getCounter=function(){return++this.counter},e.prototype.SignPoint=function(t,s){var n={};s.sort(),s.forEach(function(e){n[e]=t[e]}),t.seq&&(n.seq=t.seq),t.ts&&(n.ts=t.ts);var o=this.appkey,a=2==t.mode?this.secret:this.token,i=e.paramsParse(n),r=new MD5,h=r.hex_md5(o+"&"+i+"&"+a);return h},e.prototype.dohttp=function(e,t,s,n){var o="GET"==t?"text/plain":"application/json",a=new XMLHttpRequest;a.open(t,e),a.setRequestHeader("Content-Type",o),"GET"==t?a.send():a.send(JSON.stringify(s)),a.onerror=function(e){n(JSON.parse(a.response),null)},a.onreadystatechange=function(){4==a.readyState&&(200==a.status?n(JSON.parse(a.responseText),null):n(null," http request error "+a.responseText))}},e.prototype.http_get=function(e,t){this.dohttp(e,"GET",{},t)},e.prototype.http_post=function(e,t,s){this.dohttp(e,"POST",t,s)},e.prototype.GetRankListData=function(t){var s={pageMax:10,period:0,rankName:"totlal_rank",self:0,top:50,userID:this.userID||0,gameID:this.userID,pageIndex:1,mode:1,seq:this.getCounter(),ts:this.getTimeStamp()};s.sign=this.SignPoint(s,["gameID","userID"]);var n=e.paramsParse(s);this.http_get(e.url_Join(this.open_host,this.rank_list)+n,t)},e.prototype.GetUserInfoList=function(t,s){var n=[];t.forEach(function(e){n.push({key:e})});var o={gameID:this.gameID,userID:this.userID||0,keyList:n,mode:2,sign:"",seq:this.getCounter(),ts:this.getTimeStamp()};o.sign=this.SignPoint(o,["gameID","userID"]);var a=e.paramsParse(o);this.http_get(e.url_Join(this.open_host,this.get_game_data)+a,s)},e.prototype.setGameData=function(t,s,n){var o=[];s.forEach(function(e){o.push({key:e.userID,value:ArrayTools.Base64Encode(JSON.stringify({name:e.name,avatar:e.avatar}))})});var a={gameID:this.gameID,userID:t,dataList:o,sign:"",mode:2,seq:this.getCounter(),ts:this.getTimeStamp()};a.sign=this.SignPoint(a,["gameID","userID"]),this.http_post(e.url_Join(this.open_host,this.set_game_data),a,n)},e.prototype.delGameData=function(t,s,n){var o=[];s.forEach(function(e){o.push({key:e})});var a={gameID:this.gameID,userID:t,keyList:o,sign:"",mode:2,seq:this.getCounter(),ts:this.getTimeStamp()};a.sign=this.SignPoint(a,["gameID","userID"]);var i=e.paramsParse(a);this.http_get(e.url_Join(this.open_host,this.del_game_data)+i,n)},e.prototype.GetUserRank=function(t,s){var n={userID:t,gameID:this.gameID,type:0,rankName:"totlal_rank",rank:0,period:0,mode:1,seq:this.getCounter(),ts:this.getTimeStamp()};n.sign=this.SignPoint(n,["gameID","userID"]);var o=e.paramsParse(n);this.http_get(e.url_Join(this.open_host,this.rank_user)+o,s)},e.prototype.setUserData=function(t,s,n){var o=[];s.forEach(function(e){o.push({key:e.userID,value:ArrayTools.Base64Encode(JSON.stringify({name:e.name,avatar:e.avatar}))})});var a={gameID:this.gameID,userID:t,dataList:o,sign:"",mode:1,seq:this.getCounter(),ts:this.getTimeStamp()};a.sign=this.SignPoint(a,["gameID","userID"]);var i=e.paramsParse(a);this.http_get(e.url_Join(this.open_host,this.set_user_data)+i,n)},e.prototype.getUserData=function(t,s,n){var o=[];s.forEach(function(e){o.push({key:e})});var a={gameID:this.gameID,userID:t,keyList:o,sign:"",mode:1,seq:this.getCounter(),ts:this.getTimeStamp()};a.sign=this.SignPoint(a,["gameID","userID"]);var i=e.paramsParse(a);this.http_get(e.url_Join(this.open_host,this.get_user_data)+i,n)},e.prototype.delUserData=function(t,s,n){var o=[];s.forEach(function(e){o.push({key:e})});var a={gameID:this.gameID,userID:t,keyList:o,sign:"",mode:1,seq:this.getCounter(),ts:this.getTimeStamp()};a.sign=this.SignPoint(a,["gameID","userID"]);var i=e.paramsParse(a);this.http_get(e.url_Join(this.open_host,this.del_user_data)+i,n)},e.prototype.hashSet=function(t,s,n,o){var a={gameID:this.gameID,key:s,userID:t,value:n,sign:"",mode:1,seq:this.getCounter(),ts:this.getTimeStamp()};a.sign=this.SignPoint(a,["gameID","userID","value","key"]),this.http_post(e.url_Join(this.open_host,this.hash_get),a,o)},e.prototype.hashGet=function(t,s,n){var o={gameID:this.gameID,key:s,userID:t,sign:"",mode:1,seq:this.getCounter(),ts:this.getTimeStamp()};o.sign=this.SignPoint(o,["gameID","userID","key"]),this.http_get(e.url_Join(this.open_host,this.hash_get)+o,n)},e.prototype.thirdBind=function(t,s,n){var o={userID:0,gameID:this.gameID,openID:t,session:s,thirdFlag:1,sign:"",mode:2};o.sign=this.SignPoint(o,["gameID","openID","session","thirdFlag"]),this.http_post(e.url_Join(this.user_host,this.third_bind),o,n)},e.TestApi=function(){var t=new e;t.setUserData(GameData.gameUser.id,[{userID:12345,name:"matchvs_test",avatar:"sdjflsdkjfljlkjljl"}],function(e,t){e?console.log("TestApi success:",e):t&&console.log("TestApi fail:",t)})},e}();__reflect(MvsHttpApi.prototype,"MvsHttpApi");var aboutsene=function(e){function t(){var t=e.call(this)||this;return t.$addListener(egret.Event.ADDED_TO_STAGE,t.addToStage,t),t}return __extends(t,e),t.prototype.addToStage=function(){console.log("nihao"),this.tc1.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){console.log("return"),GameSceneView._gameScene.tohome()},this)},t.prototype.partAdded=function(t,s){e.prototype.partAdded.call(this,t,s)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t}(eui.Component);__reflect(aboutsene.prototype,"aboutsene",["eui.UIComponent","egret.DisplayObject"]);var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.createView,t),t}return __extends(t,e),t.prototype.createView=function(){this.width=this.stage.stageWidth,this.height=this.stage.stageHeight,this.bgImg=new egret.Bitmap,this.bgImg.texture=RES.getRes("loading_png"),this.addChild(this.bgImg),this.loadImg=new egret.Bitmap,this.loadImg.texture=RES.getRes("loading2_png"),this.loadImg.anchorOffsetX=this.loadImg.width/2,this.loadImg.anchorOffsetY=this.loadImg.height/2,this.loadImg.x=this.width/2,this.loadImg.y=this.height/2,this.addChild(this.loadImg),this.textField=new egret.TextField,this.addChild(this.textField),this.textField.width=480,this.textField.height=20,this.textField.y=this.height/2-this.textField.height/2,this.textField.size=14,this.textField.textAlign="center",this.addEventListener(egret.Event.ENTER_FRAME,this.updata,this)},t.prototype.updata=function(){this.loadImg.rotation+=5},t.prototype.onProgress=function(e,t){var s=Math.floor(e/t*100);this.textField.text=s+"%"},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var battle_lobby=function(e){function t(){var t=e.call(this)||this;return GameData.syncFrame=!1,t}return __extends(t,e),t.prototype.moveToChange=function(e){e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){console.log("上来"),e.scaleX=.8,e.scaleY=.8},this),e.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(t){console.log("离开"),e.scaleX=1,e.scaleY=1},this)},t.prototype.getChilds=function(e,t){switch(e){case"lab_joinRandRoom":this.moveToChange(t),this.lab_joinRandRoom=t,this.lab_joinRandRoom.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onButtonClickRandomMatch,this);break;case"lab_createRoom":this.moveToChange(t),this.lab_joinRandRoom=t,this.lab_joinRandRoom.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onButtonClickCreateRoom,this);break;case"lab_roomList":this.moveToChange(t),this.lab_joinRandRoom=t,this.lab_joinRandRoom.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onButtonClickJoinRoomList,this);break;case"lab_joinRoom":this.moveToChange(t),this.lab_joinRandRoom=t,this.lab_joinRandRoom.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onButtonClickJoinRoomSpecial,this);break;case"btn_return":this.moveToChange(t),this.btn_return=t,this.btn_return.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onButtonClicklogOutGame,this);break;case"img_header":console.log("img_header!"),this.img_header=t,this.img_header.source=GameData.gameUser.avatar,console.log("img_headerover");break;case"lab_userID":this.lab_userID=t,this.lab_userID.text="用户："+GameData.gameUser.id+"\n"+GameData.gameUser.name}},t.prototype.partAdded=function(t,s){this.getChilds(t,s),e.prototype.partAdded.call(this,t,s)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.onButtonClickRandomMatch=function(e){GameData.matchType=GameData.randomMatch,GameData.syncFrame=!1,GameSceneView._gameScene.tobatmatch(bat_match.JOINFLAG.RANDROOM)},t.prototype.onButtonClickJoinRoomList=function(e){GameData.matchType=GameData.specialMatch,GameData.syncFrame=!1,GameSceneView._gameScene.showRoomList()},t.prototype.onButtonClickCreateRoom=function(e){GameSceneView._gameScene.createRoom()},t.prototype.onButtonClickJoinRoomSpecial=function(e){GameSceneView._gameScene.joinRoomSpecial()},t.prototype.onButtonClicklogOutGame=function(e){mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_LOGOUT_RSP,this.logoutResponse,this),mvs.MsEngine.getInstance.logOut()},t.prototype.logoutResponse=function(e){mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_LOGOUT_RSP,this.logoutResponse,this);var t=e.data.status;return 200!==t?void console.log("退出登录失败!"):void GameSceneView._gameScene.tobattle_login()},t}(eui.Component);__reflect(battle_lobby.prototype,"battle_lobby",["eui.UIComponent","egret.DisplayObject"]);var battle_login=function(e){function t(){var t=e.call(this)||this;return t.addMsResponseListen(),t}return __extends(t,e),t.prototype.getMyChilds=function(e,t){"txt_gameID"==e?this.txt_gameID=t:"txt_appKey"==e?this.txt_appKey=t:"txt_secretKey"==e?this.txt_secretKey=t:"btn_enter"==e?(this.btn_enter=t,this.btn_enter.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){console.log(" environment="+GameData.DEFAULT_ENV+" gameid="+GameData.gameID);mvs.MsEngine.getInstance.init(GameData.CHANNEL,GameData.DEFAULT_ENV,GameData.gameID,GameData.appkey)},this)):"btn_clear"==e?this.btn_clear.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clearTween,this):"btn_return"==e&&(this.btn_return=t,this.btn_return.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){GameSceneView._gameScene.tobattlechoose()},this))},t.prototype.partAdded=function(t,s){this.getMyChilds(t,s),e.prototype.partAdded.call(this,t,s)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.txt_gameID.text=GameData.gameID.toString(),this.txt_appKey.text=GameData.appkey,this.txt_secretKey.text=GameData.secretKey},t.prototype.addMsResponseListen=function(){mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_INIT_RSP,this.initResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_REGISTERUSER_RSP,this.registerUserResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_LOGIN_RSP,this.loginResponse,this)},t.prototype.initResponse=function(e){return 200!==e.data.status?void console.log("init failed",e.data.status):void mvs.MsEngine.getInstance.registerUser()},t.prototype.registerUserResponse=function(e){var t=e.data;GameData.gameUser.id=t.id,GameData.gameUser.name=t.name,GameData.gameUser.avatar=t.avatar,GameData.gameUser.token=t.token,console.log("avatar",t.avatar),0==t.status&&mvs.MsEngine.getInstance.login(t.id,t.token)},t.prototype.loginResponse=function(e){MvsHttpApi.TestApi(),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_LOGIN_RSP,this.loginResponse,this);var t=e.data;console.log("loginResponse, status="+t.status),200!=t.status?console.log("登陆失败"):(console.log("登陆成功 roomID="+t.roomID),"0"!==t.roomID?(GameData.roomID=t.roomID,GameSceneView._gameScene.reconnectView()):GameSceneView._gameScene.tobattlelobby())},t.prototype.clearTween=function(e){var t=this;LocalStore_Clear(),egret.Tween.get(this.lab_clearNote).to({alpha:1},500).call(function(){t.lab_clearNote.visible=!0}).wait(500).to({alpha:0},500).call(function(){t.lab_clearNote.visible=!1})},t}(eui.Component);__reflect(battle_login.prototype,"battle_login",["eui.UIComponent","egret.DisplayObject"]);var battlechoose=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.addToStage,t),t}return __extends(t,e),t.prototype.addToStage=function(){},t.prototype.partAdded=function(t,s){e.prototype.partAdded.call(this,t,s)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.tc.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){GameSceneView._gameScene.tohome()},this),this.bt_pvp.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){console.log("tobattle_login"),GameSceneView._gameScene.tobattle_login()},this),this.bt_pve.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){GameSceneView._gameScene.tobattleScene()},this)},t}(eui.Component);__reflect(battlechoose.prototype,"battlechoose",["eui.UIComponent","egret.DisplayObject"]);var battlesense=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.addToStage,t),t}return __extends(t,e),t.prototype.addToStage=function(){this.add_herolis()},t.prototype.partAdded=function(t,s){e.prototype.partAdded.call(this,t,s)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.tc.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){GameSceneView._gameScene.tobattlechoose()},this),this.E_1.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){GameSceneView._gameScene.toE1sense()},this)},t.prototype.add_herolis=function(){var e=RES.getRes("player_json"),t=RES.getRes("card_json");if(0!=e.using[0]){var s=0;
for(var n in e.use_card)if(0!=e.use_card[n]){switch(n){case"0":this.set_team1(e.use_card[n]);break;case"1":this.set_team2(e.use_card[n]);break;case"2":this.set_team3(e.use_card[n]);break;case"3":this.set_team4(e.use_card[n])}s+=t[e.use_card[n]].HP}e.HP1=s,e.HP2=s}},t.prototype.set_team1=function(e){var t=new eui.Image;t.source="resource/art/char/"+e+".png",this.addChild(t),t.x=84,t.y=810},t.prototype.set_team2=function(e){var t=new eui.Image;t.source="resource/art/char/"+e+".png",this.addChild(t),t.x=156,t.y=810},t.prototype.set_team3=function(e){var t=new eui.Image;t.source="resource/art/char/"+e+".png",this.addChild(t),t.x=228,t.y=810},t.prototype.set_team4=function(e){var t=new eui.Image;t.source="resource/art/char/"+e+".png",this.addChild(t),t.x=300,t.y=810},t}(eui.Component);__reflect(battlesense.prototype,"battlesense",["eui.UIComponent","egret.DisplayObject"]);var CKsense=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.addToStage,t),t}return __extends(t,e),t.prototype.addToStage=function(){var e=this,t=RES.getRes("player_json");this.lab_money.text="你的金币："+t.money,this.btn_banck.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){console.log("return"),GameSceneView._gameScene.tohome()},this),this.btn_start.addEventListener(egret.TouchEvent.TOUCH_TAP,function(s){console.log("CK start"),t.money>=5e3?(e.startanimal(),t.money-=5e3,e.lab_money.text="你的金币："+t.money):e.showmessage("金币不够，努力赚钱吧")},this)},t.prototype.partAdded=function(t,s){e.prototype.partAdded.call(this,t,s)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.startanimal=function(){var e=this,t=new eui.Image,s=new eui.Image,n=new eui.Image,o=new eui.Image;t.texture=RES.getRes("back2_png"),s.texture=RES.getRes("back2_png"),n.texture=RES.getRes("back2_png"),o.texture=RES.getRes("back2_png"),this.addChild(t),this.addChild(s),this.addChild(n),this.addChild(o),t.x=828,t.y=-297,s.x=828,s.y=-297,n.x=828,n.y=-297,o.x=828,o.y=-297,egret.Tween.get(t).to({y:-2.5},1e3).to({x:204,y:448},1e3),egret.Tween.get(s).to({y:-2.5},1e3).to({x:590,y:299},1e3),egret.Tween.get(n).to({y:-2.5},1e3).to({x:1089,y:299},1e3),egret.Tween.get(o).to({y:-2.5},1e3).to({x:1496,y:448},1e3);var a=new egret.Timer(3e3,1);a.start(),a.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(s){var n=e.hero_random();console.log("CK1"+n),t.source="resource/art/bat/"+n+".png",e.addhero(n)},this);var i=new egret.Timer(4e3,1);i.start(),i.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(t){var n=e.hero_random();console.log("CK2"+n),s.source="resource/art/bat/"+n+".png",e.addhero(n)},this);var r=new egret.Timer(5e3,1);r.start(),r.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(t){var s=e.hero_random();console.log("CK3"+s),n.source="resource/art/bat/"+s+".png",e.addhero(s)},this);var h=new egret.Timer(6e3,1);h.start(),h.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(t){var s=e.hero_random();console.log("CK4"+s),o.source="resource/art/bat/"+s+".png",e.addhero(s)},this)},t.prototype.hero_random=function(){var e=["eqd","lls","zhende","bb","yz"],t=(e.length,this.randomnum(0,9));return 0==t?e[4]:(console.log("random:"+t),e[this.randomnum(0,3)])},t.prototype.randomnum=function(e,t){switch(arguments.length){case 1:return Math.round(Math.random()*e+1);case 2:return Math.round(Math.random()*(t-e));default:return 0}},t.prototype.addhero=function(e){var t=RES.getRes("player_json");t.player_card[e]+=1},t.prototype.showmessage=function(e){var t=this,s=e,n=new egret.Bitmap;n.texture=RES.getRes("toast-bg_png"),this.addChild(n),n.x=960-n.width/2,n.y=500,n.height=40;var o=new egret.TextField;o.text=s,o.size=20,this.addChild(o),o.x=960-o.width/2,o.y=510,o.height=40;var a=new egret.Timer(2e3,1);a.start(),a.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(e){t.removeChild(o),t.removeChild(n)},this)},t}(eui.Component);__reflect(CKsense.prototype,"CKsense",["eui.UIComponent","egret.DisplayObject"]);var E1sense=function(e){function t(){var t=e.call(this)||this;return t.hp_play=new eui.Image,t.hp_boss=new eui.Image,t.boss=new eui.Image,t.addEventListener(egret.Event.ADDED_TO_STAGE,t.addToStage,t),t}return __extends(t,e),t.prototype.addToStage=function(){var e=this,t=(RES.getRes("card_json"),RES.getRes("boss_json")),s=RES.getRes("player_json");s.cost=s.cost_a,t.HP2=t.HP1,s.HP2=s.HP1;this.resh(),this.add_hero(),this.over.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){e.bossturn()},this),this.escape.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){e.showmessage("逃跑惩罚，扣除500金");var s=new egret.Timer(2e3,1);s.start(),s.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(e){var t=RES.getRes("player_json");t.money-=500,GameSceneView._gameScene.tobattleScene()},e)},this)},t.prototype.partAdded=function(t,s){e.prototype.partAdded.call(this,t,s)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.add_hero=function(){var e=RES.getRes("player_json");if(0!=e.using[0]){var t=0;for(var s in e.use_card)if(0!=e.use_card[s]){switch(s){case"0":this.set_team1(e.use_card[s]);break;case"1":this.set_team2(e.use_card[s]);break;case"2":this.set_team3(e.use_card[s]);break;case"3":this.set_team4(e.use_card[s])}t++}}},t.prototype.set_team1=function(e){var t=this,s=new eui.Image;s.source="resource/art/bat/"+e+".png",this.addChild(s),s.x=68,s.y=769,s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(s){t.add_skill(e)},this)},t.prototype.set_team2=function(e){var t=this,s=new eui.Image;s.source="resource/art/bat/"+e+".png",this.addChild(s),s.x=401,s.y=769,s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(s){t.add_skill(e)},this)},t.prototype.set_team3=function(e){var t=this,s=new eui.Image;s.source="resource/art/bat/"+e+".png",this.addChild(s),s.x=734,s.y=769,s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(s){t.add_skill(e)},this)},t.prototype.set_team4=function(e){var t=this,s=new eui.Image;s.source="resource/art/bat/"+e+".png",this.addChild(s),s.x=1067,s.y=769,s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(s){t.add_skill(e)},this)},t.prototype.add_skill=function(e){var t=this,s=RES.getRes("card_json"),n=RES.getRes("boss_json"),o=RES.getRes("player_json"),a=new eui.Image,i=new eui.Image,r=new eui.Image;a.source="resource/art/char/"+e+".png",i.source="resource/art/skill/"+e+"skill1.png",r.source="resource/art/skill/"+e+"skill2.png",this.addChild(a),this.addChild(i),this.addChild(r),a.x=1384,a.y=771,i.x=1456,i.y=771,r.x=1456,r.y=946,i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(a){if(o.cost>=s[e].skill1cost)if(o.cost-=s[e].skill1cost,n.HP2-=s[e].ATK*s[e].skill1,n.HP2>0)t.resh(),t.bosshp_reduce(n.HP2/n.HP1);else{t.bosshp_reduce(0),t.showmessage("战斗胜利 金币加500"),o.money+=500;var i=new egret.Timer(2e3,1);i.start(),i.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(e){GameSceneView._gameScene.tobattleScene()},t)}else messagerManager.showfaildinE1("Cost不足")},this),r.addEventListener(egret.TouchEvent.TOUCH_TAP,function(a){if(o.cost>=s[e].skill2cost)if(o.cost-=s[e].skill2cost,"eqd"!=e)if(n.HP2-=s[e].ATK*s[e].skill2,n.HP2>0)t.resh(),t.bosshp_reduce(n.HP2/n.HP1);else{t.bosshp_reduce(0),t.showmessage("战斗胜利 金币加500"),o.money+=500;var i=new egret.Timer(2e3,1);i.start(),i.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(e){GameSceneView._gameScene.tobattleScene()},t)}else o.HP2+=s[e].ATK*s[e].skill2,t.resh(),t.playhp_reduce(o.HP2/o.HP1);console.log(e+" skill2")},this)},t.prototype.resh=function(){var e=(RES.getRes("card_json"),RES.getRes("boss_json")),t=RES.getRes("player_json");this.boss_hp.text=e.HP2,this.play_hp.text=t.HP2,this.cost.text=t.cost},t.prototype.bosshp_reduce=function(e){var t=RES.getRes("player_json"),s=t.boss;t.boss=500*e,this.hp_boss.mask=new egret.Rectangle(0,0,s,35),egret.Tween.get(this.hp_boss.mask).to({width:500*e},500)},t.prototype.playhp_reduce=function(e){var t=RES.getRes("player_json"),s=t.play;t.play=500*e,this.hp_play.mask=new egret.Rectangle(0,0,s,35),egret.Tween.get(this.hp_play.mask).to({width:500*e},500)},t.prototype.bossturn=function(){var e=RES.getRes("boss_json"),t=RES.getRes("player_json"),s=e.ATK,n=t.HP2;n>s?(t.HP2=n-s,egret.Tween.get(this.boss).to({y:0},800).to({y:-168},800),this.playhp_reduce(t.HP2/t.HP1),messagerManager.showfaildinE1("boss行动结束 cost+3"),t.cost+=3,this.resh()):(this.playhp_reduce(0),messagerManager.showfaildinE1("战斗失败"))},t.prototype.showmessage=function(e){var t=this,s=e,n=new egret.Bitmap;n.texture=RES.getRes("toast-bg_png"),this.addChild(n),n.x=960-n.width/2,n.y=500,n.height=40;var o=new egret.TextField;o.text=s,o.size=20,this.addChild(o),o.x=960-o.width/2,o.y=510,o.height=40;var a=new egret.Timer(2e3,1);a.start(),a.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(e){t.removeChild(o),t.removeChild(n)},this)},t}(eui.Component);__reflect(E1sense.prototype,"E1sense",["eui.UIComponent","egret.DisplayObject"]);var game_results=function(e){function t(){var t=e.call(this)||this;return t._userList=[],t}return __extends(t,e),t.prototype.getChilds=function(e,t){"lab_userID1"==e?this.lab_userID1=t:"lab_userID2"==e?this.lab_userID2=t:"lab_score1"==e?this.lab_score1=t:"lab_score2"==e?this.lab_score2=t:"btn_leave"==e?(this.btn_leave=t,this.btn_leave.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mbuttonExitRoom,this)):"lab_roomID"==e&&(this.lab_roomID=t)},t.prototype.partAdded=function(t,s){e.prototype.partAdded.call(this,t,s),this.getChilds(t,s)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.showResutl()},t.prototype.setResult=function(e,t){this.roomID=t;for(var s=0;s<e.length;s++){var n=new GameUser;n.avatar=e[s].avatar,n.id=e[s].id,n.isOwner=e[s].isOwner,n.name=e[s].name,n.tableID=e[s].tableID,n.pValue=e[s].pValue,n.win=e[s].win,this._userList.push(n)}},t.prototype.showResutl=function(){this.lab_roomID.text="房间号："+this.roomID;for(var e=0;e<this._userList.length;e++)this._userList[e].isOwner?(this.lab_userID1.text=this._userList[e].id,this._userList[e].win||(this.lab_score1.text="Lose",this.lab_score2.text="Win")):(this.lab_userID2.text=this._userList[e].id,this._userList[e].win||(this.lab_score2.text="Lose",this.lab_score1.text="Win"))},t.prototype.mbuttonExitRoom=function(e){console.log("onButtonLeaveRoom"),mvs.MsEngine.getInstance.leaveRoom("游戏玩完一次离开"),GameSceneView._gameScene.tobattlelobby(),GameData.isRoomOwner=!1,GameData.syncFrame=!1},t}(eui.Component);__reflect(game_results.prototype,"game_results",["eui.UIComponent","egret.DisplayObject"]);var herosense=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.addToStage,t),t}return __extends(t,e),t.prototype.addToStage=function(){this.change_json(),this.load_team(),this.lis_hero.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onChange,this)},t.prototype.partAdded=function(t,s){e.prototype.partAdded.call(this,t,s)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.tc.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){console.log("return"),GameSceneView._gameScene.tohome()},this),this.btn_sale.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){GameSceneView._gameScene.tosalesense()},this)},t.prototype.change_json=function(){var e=RES.getRes("player_json"),t=[];for(var s in e.player_card)e.player_card[s]>0&&(console.log("resource/art/hero/"+s+".png",e.player_card[s]),t.push({image:"resource/art/hero/"+s+".png",num:e.player_card[s]}));var n=new eui.ArrayCollection(t);this.lis_hero.dataProvider=n},t.prototype.onChange=function(){var e=RES.getRes("player_json"),t=[];for(var s in e.player_card)e.player_card[s]>0&&t.push(s);e.player_card[t[this.lis_hero.selectedIndex]]>=0&&this.select_team(t[this.lis_hero.selectedIndex]),console.log(this.lis_hero.selectedIndex),console.log(t[this.lis_hero.selectedIndex])},t.prototype.load_team=function(){var e=RES.getRes("player_json");if(0!=e.using[0]){for(var t in e.use_card)if(0!=e.use_card[t])switch(t){case"0":this.set_team1(e.use_card[t]);break;case"1":this.set_team2(e.use_card[t]);break;case"2":this.set_team3(e.use_card[t]);break;case"3":this.set_team4(e.use_card[t])}}},t.prototype.select_team=function(e){var t=RES.getRes("player_json");for(var s in t.using)if(0==t.using[s]){switch(t.player_card[e]-=1,this.change_json(),t.using[s]=1,s){case"0":this.set_team1(e);break;case"1":this.set_team2(e);break;case"2":this.set_team3(e);break;case"3":this.set_team4(e)}break}},t.prototype.set_team1=function(e){var t=this,s=new eui.Image,n=RES.getRes("player_json");s.source="resource/art/hero/"+e+".png",this.addChild(s),n.use_card[0]=e,s.x=228,s.y=77.5,console.log("change bankan1"),s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(o){console.log("change bankan2"),n.using[0]=0,t.removeChild(s),n.player_card[e]+=1,t.change_json()},this)},t.prototype.set_team2=function(e){var t=this,s=RES.getRes("player_json"),n=new eui.Image;n.source="resource/art/hero/"+e+".png",this.addChild(n),s.use_card[1]=e,n.x=642,n.y=77.5,n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(o){console.log("change bankan2"),s.using[1]=0,t.removeChild(n),s.player_card[e]+=1,t.change_json()},this)},t.prototype.set_team3=function(e){var t=this,s=RES.getRes("player_json"),n=new eui.Image;n.source="resource/art/hero/"+e+".png",this.addChild(n),s.use_card[2]=e,n.x=1061,n.y=77.5,n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(o){console.log("change bankan2"),s.using[2]=0,t.removeChild(n),s.player_card[e]+=1,t.change_json()},this)},t.prototype.set_team4=function(e){var t=this,s=RES.getRes("player_json"),n=new eui.Image;n.source="resource/art/hero/"+e+".png",this.addChild(n),s.use_card[3]=e,n.x=1479,n.y=77.5,n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(o){console.log("change bankan2"),s.using[3]=0,t.removeChild(n),s.player_card[e]+=1,t.change_json()},this)},t}(eui.Component);__reflect(herosense.prototype,"herosense",["eui.UIComponent","egret.DisplayObject"]);var home=function(e){function t(){var t=e.call(this)||this;return t._source=["resource/art/char/1.png","resource/art/char/2.png","resource/art/char/3.png","resource/art/char/4.png"],t.addEventListener(egret.Event.ADDED_TO_STAGE,t.addToStage,t),t}return __extends(t,e),t.prototype.addToStage=function(){var e=this;GameData.but=0,this.lis_button.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onChange,this);var t=this._source,s=new eui.Image;s.source=t[1],this.addChild(s),s.verticalCenter=0,s.y=0,this.cha.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){console.log("change bankan");var n=Math.floor(4*Math.random());s.source=t[n]},this),this.btn_gy.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){console.log("to toAboutSene"),GameSceneView._gameScene.toAboutSene()},this),this.btn_sc.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){console.log("to toshopsene"),e.showbutton()},this),this.btn_pz.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){console.log("to toherosene"),GameSceneView._gameScene.toHeroScene()},this),this.btn_zd.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){GameSceneView._gameScene.tobattlechoose()},this)},t.prototype.partAdded=function(t,s){e.prototype.partAdded.call(this,t,s)},t.prototype.showbutton=function(){var e=[];0==GameData.but?(e.push({name:"商城"},{name:"抽卡"}),GameData.but=1):GameData.but=0;var t=new eui.ArrayCollection(e);this.lis_button.dataProvider=t},t.prototype.onChange=function(){0==this.lis_button.selectedIndex?GameSceneView._gameScene.toShopSene():GameSceneView._gameScene.tocksense()},t}(eui.Component);__reflect(home.prototype,"home",["eui.UIComponent","egret.DisplayObject"]);var matchroom=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.getChild=function(e,t){var s=this;"lab_userID"==e?(this.lab_userID=t,this.lab_userID.text="用户："+GameData.gameUser.id+"\n"+GameData.gameUser.name):"img_header"==e?(this.img_header=t,this.img_header.source=GameData.gameUser.avatar):"lab_note"==e?(this.lab_note=t,this.lab_note.visible=!1):"btn_return"==e?(this.btn_return=t,this.btn_return.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mbuttonExitRoom,this)):"btn_start"==e?(this.btn_start=t,this.btn_start.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mbuttonEnterRoom,this)):"rect_roomID"==e?this.rect_roomID=t:"edt_roomID"==e&&(this.edt_roomID=t,this.edt_roomID.addEventListener(eui.UIEvent.CHANGE,function(e){s.roomIDIsOK()},this))},t.prototype.roomIDIsOK=function(){var e=this.edt_roomID.text;return""==e?void this.showNote("",!1):void(/^[0-9]+$/.test(e)?this.showNote("",!1):this.showNote("请求输入有效的房间号",!0))},t.prototype.partAdded=function(t,s){e.prototype.partAdded.call(this,t,s),this.getChild(t,s)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.showNote=function(e,t){this.lab_note.visible=t,this.lab_note.text=e,t?(this.rect_roomID.strokeWeight=2,this.rect_roomID.strokeColor=16275544,this.rect_roomID.fillColor=16770533):(this.rect_roomID.strokeWeight=0,this.rect_roomID.strokeColor=16777215,this.rect_roomID.fillColor=16777215)},t.prototype.mbuttonExitRoom=function(e){GameSceneView._gameScene.tobattlelobby()},t.prototype.mbuttonEnterRoom=function(e){var t=this.edt_roomID.text;if(!/^[0-9]+$/.test(t)||""==t)return void this.showNote("无效的房间号",!0);var s={name:GameData.gameUser.name,avatar:GameData.gameUser.avatar},n=(JSON.stringify(s),new MsRoomFilter(GameData.maxPlayerNum,0,0,""));mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_GETROOMLIST_RSP,this.getRoomListResponse,this),mvs.MsEngine.getInstance.getRoomList(n)},t.prototype.getRoomListResponse=function(e){var t=e.data.status,s=e.data.roomInfos;if(200!==t)return void this.showNote("房间查询错误"+t,!0);for(var n=this.edt_roomID.text,o=!1,a=0;a<s.length;a++)s[a].roomID==n.trim()&&(o=!0);return 0==o?void this.showNote("没有查找到此房间，请重新输入",!0):(mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_GETROOMLIST_RSP,this.getRoomListResponse,this),void GameSceneView._gameScene.tobatmatch(bat_match.JOINFLAG.WITHROOMID,n.trim()))},t}(eui.Component);__reflect(matchroom.prototype,"matchroom",["eui.UIComponent","egret.DisplayObject"]);var PVPBattle=function(e){function t(){var t=e.call(this)||this;return t.hpplay=new eui.Rect,t.hpemy=new eui.Rect,t._fontSize=22,t.moveTimeer=new egret.Timer(100,0),t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){var t=this;GameData.width=this.stage.stageWidth,GameData.height=this.stage.stageHeight,1==GameData.isRoomOwner&&(GameData.gameUser.myturn=!0),this.over.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){GameData.gameUser.myturn=!1;var s={action:GameData.changeTurnEvent};mvs.MsEngine.getInstance.sendEvent(JSON.stringify(s));t.showmessage("回合结合 现在是他的回合"),GameData.my_cost+=3,t.resh()},this),this.escape.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){t.showmessage("逃跑惩罚，扣除500金");var s=new egret.Timer(2e3,1);s.start(),s.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(e){var t=RES.getRes("player_json");t.money-=500,GameSceneView._gameScene.tobattleScene()},t)},this),this.startLoad()},t.prototype.startLoad=function(){if(GameData.syncFrame===!0&&GameData.isRoomOwner===!0){var e=mvs.MsEngine.getInstance.setFrameSync(GameData.frameRate);0!==e&&console.log("设置帧同步率失败,错误码:"+e)}GameData.isGameOver=!1,this._gameTime=GameData.playerTime,this._score=0,this._receiveCountValue=0,this.startanimal();var t=new eui.Label;t.textColor=16777215,t.fontFamily="Tahoma",t.text="用户id:"+GameData.gameUser.id+"["+GameData.gameUser.name+"]",t.size=this._fontSize,t.x=20,t.y=20,this.addChild(t);var s=new eui.Label;s.textColor=16777215,s.fontFamily="Tahoma",s.text="房间号:"+GameData.roomID,this._roomID=GameData.roomID,s.size=this._fontSize,s.x=20,s.y=60,this.addChild(s);var n=new eui.Label;n.textColor=16777215,n.fontFamily="Tahoma",n.size=this._fontSize,n.x=20,n.y=100,this._scoreLabel=n,this.addChild(this._scoreLabel);var o=new eui.Label;o.textColor=16777215,o.fontFamily="Tahoma",o.size=this._fontSize,o.x=20,o.y=GameData.height-200,this._delayLabel=o,this.addChild(this._delayLabel);var a=new eui.Label;a.textColor=16777215,a.fontFamily="Tahoma",a.size=this._fontSize,a.x=20,a.y=GameData.height-80,this._receiveMsgCountLabel=a,this.addChild(this._receiveMsgCountLabel);var i=new eui.Label;i.textColor=16777215,i.fontFamily="Tahoma",i.size=this._fontSize,i.x=GameData.width/2,i.y=20,i.text="回合："+this._gameTime.toString(),i.size=60,this._countDownLabel=i,this.addChild(this._countDownLabel);var r=new eui.Label;r.textColor=16711680,r.fontFamily="Tahoma",r.size=this._fontSize,r.x=GameData.width/2,r.y=50,r.text="",this._netWorkNoticeLabel=r,this.addChild(this._netWorkNoticeLabel),this.inithp(),this.addMsResponseListen()},t.prototype.addMsResponseListen=function(){mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_SENDEVENT_NTFY,this.sendEventNotify,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_LEAVEROOM_NTFY,this.leaveRoomNotify,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_NETWORKSTATE_NTFY,this.networkStateNotify,this)},t.prototype.release=function(){mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_SENDEVENT_NTFY,this.sendEventNotify,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_LEAVEROOM_NTFY,this.leaveRoomNotify,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_NETWORKSTATE_NTFY,this.networkStateNotify,this)},t.prototype.inithp=function(){var e=RES.getRes("player_json"),t=RES.getRes("card_json");if(e.cost=e.cost_a,0!=e.using[0]){var s=0;for(var n in e.use_card)if(0!=e.use_card[n]){switch(n){case"0":this.set_team1(e.use_card[n]);break;case"1":this.set_team2(e.use_card[n]);break;case"2":this.set_team3(e.use_card[n]);break;case"3":this.set_team4(e.use_card[n])}s+=t[e.use_card[n]].HP}GameData.my_hp_max=s,GameData.my_hp_now=s,this.resh();var o={action:GameData.newStarEvent,hp:s,head:GameData.gameUser.avatar},a=mvs.MsEngine.getInstance.sendEvent(JSON.stringify(o));if(!a||0!==a.result)return console.log("HP发送失败");console.log("HP发送成功")}},t.prototype.set_team1=function(e){var t=this,s=new eui.Image;s.source="resource/art/bat/"+e+".png",this.addChild(s),s.x=162,s.y=347,s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(s){t.add_skill(e)},this)},t.prototype.set_team2=function(e){var t=this,s=new eui.Image;s.source="resource/art/bat/"+e+".png",this.addChild(s),s.x=538,s.y=347,s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(s){t.add_skill(e)},this)},t.prototype.set_team3=function(e){var t=this,s=new eui.Image;s.source="resource/art/bat/"+e+".png",this.addChild(s),s.x=162,s.y=713,s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(s){t.add_skill(e)},this)},t.prototype.set_team4=function(e){var t=this,s=new eui.Image;s.source="resource/art/bat/"+e+".png",this.addChild(s),s.x=538,s.y=713,s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(s){t.add_skill(e)},this)},t.prototype.add_skill=function(e){var t=this,s=RES.getRes("card_json"),n=RES.getRes("boss_json"),o=RES.getRes("player_json"),a=new eui.Image,i=new eui.Image,r=new eui.Image;a.source="resource/art/char/"+e+".png",i.source="resource/art/skill/"+e+"skill1.png",r.source="resource/art/skill/"+e+"skill2.png",this.addChild(a),this.addChild(i),this.addChild(r),a.x=928,a.y=570,i.x=1e3,i.y=575,r.x=1e3,r.y=745,i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(n){if(GameData.gameUser.myturn)if(o.cost>=s[e].skill1cost){o.cost-=s[e].skill1cost,GameData.emy_hp_now-=s[e].ATK*s[e].skill1,console.log("emy_hp_now:"+GameData.emy_hp_now),GameData.my_cost=o.cost;var a={action:GameData.changeStarEvent,hp:GameData.emy_hp_now,myhp:GameData.my_hp_now,id:GameData.gameUser.id};mvs.MsEngine.getInstance.sendEvent(JSON.stringify(a));if(GameData.my_cost=o.cost,GameData.emy_hp_now>0)t.resh(),t.emyhp_reduce(GameData.emy_hp_now/GameData.emy_hp_max);else{var i=0;for(i=0;i<GameData.playerUserIds.length;i++)if(GameData.playerUserIds[i].id==GameData.gameUser.id){GameData.playerUserIds[i].win=!0;break}GameSceneView._gameScene.showResult(GameData.playerUserIds,t._roomID)}}else messagerManager.showfaildinE1("Cost不足")},this),r.addEventListener(egret.TouchEvent.TOUCH_TAP,function(a){if(GameData.gameUser.myturn&&o.cost>=s[e].skill2cost)if(o.cost-=s[e].skill2cost,"eqd"!=e)if(GameData.emy_hp_now-=s[e].ATK*s[e].skill2,GameData.my_cost=o.cost,n.HP2>0)t.resh(),t.emyhp_reduce(GameData.emy_hp_now/GameData.emy_hp_max);else{t.emyhp_reduce(0),t.showmessage("战斗胜利"),o.money+=500;var i=new egret.Timer(2e3,1);i.start(),i.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(e){var s=0;for(s=0;s<GameData.playerUserIds.length;s++)if(GameData.playerUserIds[s].id==GameData.gameUser.id){GameData.playerUserIds[s].win=!0;break}GameSceneView._gameScene.showResult(GameData.playerUserIds,t._roomID)},t)}else GameData.my_hp_now+=s[e].ATK*s[e].skill2,t.resh(),t.myhp_reduce(GameData.my_hp_now/GameData.my_hp_max)},this);var h={action:GameData.changeStarEvent,hp:GameData.emy_hp_now,myhp:GameData.my_hp_now,id:GameData.gameUser.id};mvs.MsEngine.getInstance.sendEvent(JSON.stringify(h))},t.prototype.startanimal=function(){console.log("startanimal"),this.hpplay.mask=new egret.Rectangle(0,0,28,0),egret.Tween.get(this.hpplay.mask).to({height:792},3e3),this.hpemy.mask=new egret.Rectangle(0,0,26,0),egret.Tween.get(this.hpemy.mask).to({height:582},3e3)},t.prototype.sendEventNotify=function(e){var t=e.data;if(t&&t.cpProto)if(t.cpProto.indexOf(GameData.newStarEvent)>=0){if(t.srcUserId!=GameData.gameUser.id){var s=JSON.parse(t.cpProto);GameData.emy_hp_max=s.hp,GameData.emy_hp_now=s.hp,GameData.emy_head=s.head,this.resh()}}else if(t.cpProto.indexOf(GameData.changeStarEvent)>=0){var s=JSON.parse(t.cpProto);if(GameData.my_hp_now=s.hp,GameData.emy_hp_now=s.myhp,GameData.my_hp_now<=0){var n=0;for(n=0;n<GameData.playerUserIds.length;n++)if(GameData.playerUserIds[n].id==s.id){GameData.playerUserIds[n].win=!0;break}GameSceneView._gameScene.showResult(GameData.playerUserIds,this._roomID)}this.resh(),this.myhp_reduce(GameData.my_hp_now/GameData.my_hp_max)}else t.cpProto.indexOf(GameData.changeTurnEvent)>=0&&(this.showmessage("你的回合开始"),GameData.gameUser.myturn=!0)},t.prototype.resh=function(){this.lab_1.text=GameData.my_hp_now.toString(),this.lab_2.text=GameData.emy_hp_now.toString(),this.cost.text=GameData.my_cost.toString(),this.img_header.source=GameData.emy_head},t.prototype.myhp_reduce=function(e){var t=GameData.my_hp;GameData.my_hp=792*(GameData.my_hp_now/GameData.my_hp_max),this.hpplay.mask=new egret.Rectangle(0,0,28,t),egret.Tween.get(this.hpplay.mask).to({height:GameData.my_hp},1e3)},t.prototype.emyhp_reduce=function(e){var t=GameData.emy_hp;GameData.emy_hp=582*(GameData.emy_hp_now/GameData.emy_hp_max),this.hpemy.mask=new egret.Rectangle(0,0,26,t),egret.Tween.get(this.hpemy.mask).to({height:GameData.emy_hp},1e3)},t.prototype.leaveRoomNotify=function(e){GameData.isGameOver=!0,this.release(),console.log("2结束房间ID：",GameData.roomID,GameData.playerUserIds),GameSceneView._gameScene.showResult(GameData.playerUserIds,this._roomID)},t.prototype.partAdded=function(t,s){e.prototype.partAdded.call(this,t,s)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.networkStateNotify=function(e){var t=e.data;console.log("玩家："+t.userID+" state:"+t.state),1===t.state?(this._netWorkNoticeLabel.text="玩家掉线:"+t.userID,console.log("玩家掉线:"+t.userID)):2===t.state?(console.log("玩家已经重连进来"),this._netWorkNoticeLabel.text=""):(console.log("玩家："+t.userID+" 重新连接失败！离开房间，游戏结束"),mvs.MsEngine.getInstance.leaveRoom("玩累了"),this.release(),GameSceneView._gameScene.tobattlelobby(),GameData.isGameOver=!0,GameData.isRoomOwner=!1,GameData.syncFrame=!1)},t.prototype.showmessage=function(e){var t=this,s=e,n=new egret.Bitmap;n.texture=RES.getRes("toast-bg_png"),this.addChild(n),n.x=960-n.width/2,n.y=500,n.height=40;var o=new egret.TextField;o.text=s,o.size=20,this.addChild(o),o.x=960-o.width/2,o.y=510,o.height=40;var a=new egret.Timer(2e3,1);a.start(),a.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(e){t.removeChild(o),t.removeChild(n)},this)},t}(eui.Component);__reflect(PVPBattle.prototype,"PVPBattle",["eui.UIComponent","egret.DisplayObject"]);var ReconnectUI=function(e){function t(){var t=e.call(this)||this;return t._reconnctTimes=1,t._totalTimes=5,t.addMsResponseListen(),t}return __extends(t,e),t.prototype.partAdded=function(t,s){e.prototype.partAdded.call(this,t,s),"btn_return"==t&&(this.btn_return=s,this.btn_return.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mbuttonExitRoom,this))},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.lab_note.text="重连中..."+this._reconnctTimes+"/"+this._totalTimes,this._timer=new egret.Timer(1e3,5),this._timer.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this._timer.start()},t.prototype.addMsResponseListen=function(){mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_RECONNECT_RSP,this.reconnectResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_ERROR_RSP,this.errorResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_LEAVEROOM_RSP,this.leaveRoomResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_SENDEVENT_RSP,this.sendEventResponse,this)},t.prototype.release=function(){mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_ERROR_RSP,this.errorResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_LEAVEROOM_RSP,this.leaveRoomResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_SENDEVENT_RSP,this.sendEventResponse,this),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_RECONNECT_RSP,this.reconnectResponse,this)},t.prototype.mbuttonExitRoom=function(e){GameSceneView._gameScene.tobattle_login()},t.prototype.timerFunc=function(e){this.lab_note.text="重连中..."+this._reconnctTimes+"/"+this._totalTimes,console.log(this.lab_note.text);var t=mvs.MsEngine.getInstance.reconnect();this._reconnctTimes++,this._reconnctTimes>this._totalTimes&&(this._timer.stop(),0===t?(mvs.MsEngine.getInstance.leaveRoom(""),GameSceneView._gameScene.tobattlelobby()):(mvs.MsEngine.getInstance.leaveRoom(""),GameSceneView._gameScene.tobattle_login()),this.release())},t.prototype.reconnectResponse=function(e){console.log("重新连接成功");var t=e.data,s=t.roomUserInfoList,n=t.roomInfo;this._timer.stop(),t.status&&200===t.status?(console.log("重连成功status:"+t.status+" 重连次数："+this._reconnctTimes),GameData.playerUserIds=[],GameData.playerUserIds.push(GameData.gameUser),s.forEach(function(e){if(console.log("用户ID："+e.userID),GameData.gameUser.id!==e.userID){var t={name:"",avatar:""};""!==e.userProfile&&(t=JSON.parse(e.userProfile));var s=new GameUser;s.avatar=t.avatar,s.name=t.name,s.id=e.userID,s.isOwner=e.userID==n.ownerId,GameData.playerUserIds.push(s)}}),GameData.roomID=n.roomID,GameData.isRoomOwner=!1,GameData.playerUserIds.length===GameData.maxPlayerNum&&2===n.state?this.sendReadyEvent():(console.log("还没有开始游戏或者游戏结束, 退出到大厅"),mvs.MsEngine.getInstance.leaveRoom("leaveRoom"),this.release(),GameSceneView._gameScene.tobattlelobby())):(console.log("重连失败"+this._reconnctTimes),this.lab_note.text="重连失败......"+this._reconnctTimes+"/"+this._totalTimes,this.release(),GameSceneView._gameScene.tobattle_login())},t.prototype.sendEventResponse=function(e){var t=e.data;if(200===t.status){var s=GameData.events[t.sequence];s&&s.action===GameData.reconnectReadyEvent&&(delete GameData.events[t.sequence],this.release(),GameSceneView._gameScene.play())}else this.release(),mvs.MsEngine.getInstance.leaveRoom("leaveRoom"),GameSceneView._gameScene.tobattlelobby()},t.prototype.errorResponse=function(e){this.lab_note.text="重连失败！",this._timer.stop()},t.prototype.mbuttonCancleBtn=function(e){this._timer.stop(),this.release(),mvs.MsEngine.getInstance.leaveRoom("")},t.prototype.leaveRoomResponse=function(e){console.log("取消重新连接，离开房间:"+e.status)},t.prototype.sendReadyEvent=function(){var e={action:GameData.reconnectReadyEvent,userID:GameData.gameUser.id},t=mvs.MsEngine.getInstance.sendEvent(JSON.stringify(e));
return t&&0===t.result?(GameData.events[t.sequence]=e,void console.log("重连发送信息成功")):(console.log("重连发送信息失败"),mvs.MsEngine.getInstance.leaveRoom("leaveRoom"),GameSceneView._gameScene.tobattlelobby(),void this.release())},t}(eui.Component);__reflect(ReconnectUI.prototype,"ReconnectUI",["eui.UIComponent","egret.DisplayObject"]);var RoomItem=function(e){function t(t){var s=e.call(this)||this;return s._parent=null,s.isme=!1,s._parent=t,s.skinName="RoomItemSkin",s}return __extends(t,e),t.prototype.partAdded=function(t,s){e.prototype.partAdded.call(this,t,s)},t.prototype.showInfo=function(e,t,s){this.lab_roomID.text="房间号："+e;var n=1==t?"待加入":"已关闭";this.lab_state.text="房间状态："+n,mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_GETROOMDETAIL_RSP,this.getRoomDetailResponse,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_GETROOMDETAIL_RSP,this.getRoomDetailResponse,this)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.btn_enter.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mbuttonEnterRoom,this)},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this._parent=this.data._parent,this.layContents(this.data._roomID,this.data._state,this.data._max),this.showInfo(this._roomID,this._state,this._max)},t.prototype.layContents=function(e,t,s){this._roomID=e,this._state=t,this._max=s},t.prototype.getRoomDetail=function(e){mvs.MsEngine.getInstance.getRoomDetail(e)},t.prototype.getRoomDetailResponse=function(e){var t=e.data;return 200!==t.status?void console.log("getRoomDetailResponse error status:"+t.status):void(1===t.state?(console.log("检查房间状态为：开放状态可以进入"),this.Release(),this.isme&&GameSceneView._gameScene.tobatmatch(bat_match.JOINFLAG.WITHROOMID,this._roomID)):console.log("检查房间状态为：关闭状态不可以进入，请刷新房间列表"))},t.prototype.mbuttonEnterRoom=function(e){console.log("点击按钮加入房间号：",this._roomID),this.isme=!0,this.getRoomDetail(this._roomID)},t.prototype.removeEventListe=function(){mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_GETROOMDETAIL_RSP,this.getRoomDetailResponse,this),this.btn_enter.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.mbuttonEnterRoom,this)},t.prototype.Release=function(){this._parent.Release(),this.removeEventListe()},t}(eui.ItemRenderer);__reflect(RoomItem.prototype,"RoomItem");var RoomListUI=function(e){function t(){var t=e.call(this)||this;return t.roomItemA=new eui.ArrayCollection([]),t._roomListSprite=null,t}return __extends(t,e),t.prototype.getChild=function(e,t){"lab_userID"==e?(this.lab_userID=t,this.lab_userID.text="用户："+GameData.gameUser.id+"\n"+GameData.gameUser.name):"img_header"==e?(this.img_header=t,this.img_header.source=GameData.gameUser.avatar):"btn_return"==e?(this.btn_return=t,this.btn_return.addEventListener(egret.TouchEvent.TOUCH_TAP,this.mbuttonExitRoom,this)):"data_roomList"==e?this.data_roomList=t:"lab_getInfo"==e&&(this.lab_getInfo=t)},t.prototype.partAdded=function(t,s){e.prototype.partAdded.call(this,t,s),this.getChild(t,s)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this._roomListSprite=new egret.Sprite,this.addChild(this._roomListSprite),this.getRoomListEx(),this._timer=new egret.Timer(2e3,0),this._timer.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),mvs.MsResponse.getInstance.addEventListener(mvs.MsEvent.EVENT_GETROOMLIST_EX_RSP,this.getRoomListExResponse,this),this._timer.start()},t.prototype.mbuttonExitRoom=function(e){this._timer.stop(),GameSceneView._gameScene.tobattlelobby()},t.prototype.timerFunc=function(e){this.getRoomListEx()},t.prototype.getRoomListEx=function(){var e=new MsRoomFilterEx(GameData.createRoomInfo.maxPlayer,GameData.createRoomInfo.mode,GameData.createRoomInfo.canWatch,"",0,1,1,0,0,3);mvs.MsEngine.getInstance.getRoomListEx(e)},t.prototype.getRoomListExResponse=function(e){var t=e.data;if(200!=t.status)return void(this.lab_getInfo.text="获取失败!");if(0==t.roomAttrs.length)return this.lab_getInfo.text="当前没有房间",void(this.data_roomList.dataProvider=new eui.ArrayCollection([]));this.lab_getInfo.text="",this.roomItemA.removeAll();for(var s=0;s<t.roomAttrs.length;s++){console.log("房间数据量：",t.roomAttrs.length);var n={_parent:this,_roomID:t.roomAttrs[s].roomID,_state:t.roomAttrs[s].state,_max:t.roomAttrs[s].maxPlayer};this.roomItemA.addItem(n)}this.data_roomList.dataProvider=this.roomItemA,this.data_roomList.itemRenderer=RoomItem},t.prototype.Release=function(){this._timer.stop(),mvs.MsResponse.getInstance.removeEventListener(mvs.MsEvent.EVENT_GETROOMLIST_EX_RSP,this.getRoomListExResponse,this)},t}(eui.Component);__reflect(RoomListUI.prototype,"RoomListUI",["eui.UIComponent","egret.DisplayObject"]);var salesense=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.addToStage,t),t}return __extends(t,e),t.prototype.addToStage=function(){this.change_json();var e=RES.getRes("player_json");this.lab_money.text="金币："+e.money,this.lis_hero.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onChange,this)},t.prototype.change_json=function(){var e=RES.getRes("player_json"),t=[];for(var s in e.player_card)e.player_card[s]>0&&(console.log("resource/art/hero/"+s+".png",e.player_card[s]),t.push({image:"resource/art/hero/"+s+".png",num:e.player_card[s]}));var n=new eui.ArrayCollection(t);this.lis_hero.dataProvider=n},t.prototype.onChange=function(){var e=RES.getRes("player_json"),t=[];for(var s in e.player_card)e.player_card[s]>0&&t.push(s);e.player_card[t[this.lis_hero.selectedIndex]]>=0&&this.select_team(t[this.lis_hero.selectedIndex]),console.log(this.lis_hero.selectedIndex),console.log(t[this.lis_hero.selectedIndex])},t.prototype.select_team=function(e){var t=RES.getRes("player_json");t.player_card[e]-=1,this.change_json(),t.money+=500,this.lab_money.text="金币："+t.money,this.showmessage("您出售了"+e+"获得了500金")},t.prototype.partAdded=function(t,s){e.prototype.partAdded.call(this,t,s)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.btn_tc.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){console.log("return"),GameSceneView._gameScene.toHeroScene()},this)},t.prototype.showmessage=function(e){var t=this,s=e,n=new egret.Bitmap;n.texture=RES.getRes("toast-bg_png"),this.addChild(n),n.x=960-n.width/2,n.y=500,n.height=40;var o=new egret.TextField;o.text=s,o.size=20,this.addChild(o),o.x=960-o.width/2,o.y=510,o.height=40;var a=new egret.Timer(2e3,1);a.start(),a.addEventListener(egret.TimerEvent.TIMER_COMPLETE,function(e){t.removeChild(o),t.removeChild(n)},this)},t}(eui.Component);__reflect(salesense.prototype,"salesense",["eui.UIComponent","egret.DisplayObject"]);var shopsene=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.addToStage,t),t}return __extends(t,e),t.prototype.addToStage=function(){this.fresh_money();var e=[{image:"resource/art/hero/bb.png",name:"BB",isSelected:!1},{image:"resource/art/hero/eqd.png",name:"恩奇都",isSelected:!1},{image:"resource/art/hero/lls.png",name:"莉莉丝",isSelected:!1},{image:"resource/art/hero/zhende.png",name:"贞德",isSelected:!1}],t=new eui.ArrayCollection(e);this.lis_shop.dataProvider=t,this.lis_shop.itemRenderer=shoplist_item,this.tc2.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){console.log("return"),GameSceneView._gameScene.tohome()},this),this.shop_gouma.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickSelect,this)},t.prototype.partAdded=function(t,s){e.prototype.partAdded.call(this,t,s)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.onClickSelect=function(e){for(var t=this.lis_shop.dataProvider,s=RES.getRes("player_json"),n=[],o=s.money,a=0,i=0;i<t.length;i++){var r=t.getItemAt(i);r.isSelected&&(n.push(r.name),a+=1e3)}if(console.log("money"+o+"need"+a),o>=a){o-=a,s.money=o,this.shop_money.text=o,SceneManager.showInfo(n);for(var i=0;i<t.length;i++){var r=t.getItemAt(i);r.isSelected&&this.date_change(r.name)}}else messagerManager.showfaildinshop("金币不够")},t.prototype.fresh_money=function(){var e=RES.getRes("player_json");for(var t in e)if("money"==t){var s=e[t];this.shop_money.text=s}},t.prototype.date_change=function(e){switch(e){case"BB":this.add_data("bb");break;case"恩奇都":this.add_data("eqd");break;case"莉莉丝":this.add_data("lls");break;case"贞德":this.add_data("zhende")}},t.prototype.add_data=function(e){console.log("add"+e);var t=RES.getRes("player_json"),s=t.player_card[e];s+=1,t.player_card[e]=s},t}(eui.Component);__reflect(shopsene.prototype,"shopsene",["eui.UIComponent","egret.DisplayObject"]);var MD5=function(){function e(){this.hexcase=0,this.b64pad=""}return e.prototype.hex_md5=function(e){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(e)))},e.prototype.b64_md5=function(e){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(e)))},e.prototype.any_md5=function(e,t){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(e)),t)},e.prototype.hex_hmac_md5=function(e,t){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)))},e.prototype.b64_hmac_md5=function(e,t){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)))},e.prototype.any_hmac_md5=function(e,t,s){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)),s)},e.prototype.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},e.prototype.rstr_md5=function(e){return this.binl2rstr(this.binl_md5(this.rstr2binl(e),8*e.length))},e.prototype.rstr_hmac_md5=function(e,t){var s=this.rstr2binl(e);s.length>16&&(s=this.binl_md5(s,8*e.length));for(var n=Array(16),o=Array(16),a=0;16>a;a++)n[a]=909522486^s[a],o[a]=1549556828^s[a];var i=this.binl_md5(n.concat(this.rstr2binl(t)),512+8*t.length);return this.binl2rstr(this.binl_md5(o.concat(i),640))},e.prototype.rstr2hex=function(e){try{this.hexcase}catch(t){this.hexcase=0}for(var s,n=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",o="",a=0;a<e.length;a++)s=e.charCodeAt(a),o+=n.charAt(s>>>4&15)+n.charAt(15&s);return o},e.prototype.rstr2b64=function(e){try{this.b64pad}catch(t){this.b64pad=""}for(var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",o=e.length,a=0;o>a;a+=3)for(var i=e.charCodeAt(a)<<16|(o>a+1?e.charCodeAt(a+1)<<8:0)|(o>a+2?e.charCodeAt(a+2):0),r=0;4>r;r++)n+=8*a+6*r>8*e.length?this.b64pad:s.charAt(i>>>6*(3-r)&63);return n},e.prototype.rstr2any=function(e,t){var s,n,o,a,i,r=t.length,h=Array(Math.ceil(e.length/2));for(s=0;s<h.length;s++)h[s]=e.charCodeAt(2*s)<<8|e.charCodeAt(2*s+1);var c=Math.ceil(8*e.length/(Math.log(t.length)/Math.log(2))),l=Array(c);for(n=0;c>n;n++){for(i=Array(),a=0,s=0;s<h.length;s++)a=(a<<16)+h[s],o=Math.floor(a/r),a-=o*r,(i.length>0||o>0)&&(i[i.length]=o);l[n]=a,h=i}var m="";for(s=l.length-1;s>=0;s--)m+=t.charAt(l[s]);return m},e.prototype.str2rstr_utf8=function(e){for(var t,s,n="",o=-1;++o<e.length;)t=e.charCodeAt(o),s=o+1<e.length?e.charCodeAt(o+1):0,t>=55296&&56319>=t&&s>=56320&&57343>=s&&(t=65536+((1023&t)<<10)+(1023&s),o++),127>=t?n+=String.fromCharCode(t):2047>=t?n+=String.fromCharCode(192|t>>>6&31,128|63&t):65535>=t?n+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|63&t):2097151>=t&&(n+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|63&t));return n},e.prototype.str2rstr_utf16le=function(e){for(var t="",s=0;s<e.length;s++)t+=String.fromCharCode(255&e.charCodeAt(s),e.charCodeAt(s)>>>8&255);return t},e.prototype.str2rstr_utf16be=function(e){for(var t="",s=0;s<e.length;s++)t+=String.fromCharCode(e.charCodeAt(s)>>>8&255,255&e.charCodeAt(s));return t},e.prototype.rstr2binl=function(e){for(var t=Array(e.length>>2),s=0;s<t.length;s++)t[s]=0;for(var s=0;s<8*e.length;s+=8)t[s>>5]|=(255&e.charCodeAt(s/8))<<s%32;return t},e.prototype.binl2rstr=function(e){for(var t="",s=0;s<32*e.length;s+=8)t+=String.fromCharCode(e[s>>5]>>>s%32&255);return t},e.prototype.binl_md5=function(e,t){e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t;for(var s=1732584193,n=-271733879,o=-1732584194,a=271733878,i=0;i<e.length;i+=16){var r=s,h=n,c=o,l=a;s=this.md5_ff(s,n,o,a,e[i+0],7,-680876936),a=this.md5_ff(a,s,n,o,e[i+1],12,-389564586),o=this.md5_ff(o,a,s,n,e[i+2],17,606105819),n=this.md5_ff(n,o,a,s,e[i+3],22,-1044525330),s=this.md5_ff(s,n,o,a,e[i+4],7,-176418897),a=this.md5_ff(a,s,n,o,e[i+5],12,1200080426),o=this.md5_ff(o,a,s,n,e[i+6],17,-1473231341),n=this.md5_ff(n,o,a,s,e[i+7],22,-45705983),s=this.md5_ff(s,n,o,a,e[i+8],7,1770035416),a=this.md5_ff(a,s,n,o,e[i+9],12,-1958414417),o=this.md5_ff(o,a,s,n,e[i+10],17,-42063),n=this.md5_ff(n,o,a,s,e[i+11],22,-1990404162),s=this.md5_ff(s,n,o,a,e[i+12],7,1804603682),a=this.md5_ff(a,s,n,o,e[i+13],12,-40341101),o=this.md5_ff(o,a,s,n,e[i+14],17,-1502002290),n=this.md5_ff(n,o,a,s,e[i+15],22,1236535329),s=this.md5_gg(s,n,o,a,e[i+1],5,-165796510),a=this.md5_gg(a,s,n,o,e[i+6],9,-1069501632),o=this.md5_gg(o,a,s,n,e[i+11],14,643717713),n=this.md5_gg(n,o,a,s,e[i+0],20,-373897302),s=this.md5_gg(s,n,o,a,e[i+5],5,-701558691),a=this.md5_gg(a,s,n,o,e[i+10],9,38016083),o=this.md5_gg(o,a,s,n,e[i+15],14,-660478335),n=this.md5_gg(n,o,a,s,e[i+4],20,-405537848),s=this.md5_gg(s,n,o,a,e[i+9],5,568446438),a=this.md5_gg(a,s,n,o,e[i+14],9,-1019803690),o=this.md5_gg(o,a,s,n,e[i+3],14,-187363961),n=this.md5_gg(n,o,a,s,e[i+8],20,1163531501),s=this.md5_gg(s,n,o,a,e[i+13],5,-1444681467),a=this.md5_gg(a,s,n,o,e[i+2],9,-51403784),o=this.md5_gg(o,a,s,n,e[i+7],14,1735328473),n=this.md5_gg(n,o,a,s,e[i+12],20,-1926607734),s=this.md5_hh(s,n,o,a,e[i+5],4,-378558),a=this.md5_hh(a,s,n,o,e[i+8],11,-2022574463),o=this.md5_hh(o,a,s,n,e[i+11],16,1839030562),n=this.md5_hh(n,o,a,s,e[i+14],23,-35309556),s=this.md5_hh(s,n,o,a,e[i+1],4,-1530992060),a=this.md5_hh(a,s,n,o,e[i+4],11,1272893353),o=this.md5_hh(o,a,s,n,e[i+7],16,-155497632),n=this.md5_hh(n,o,a,s,e[i+10],23,-1094730640),s=this.md5_hh(s,n,o,a,e[i+13],4,681279174),a=this.md5_hh(a,s,n,o,e[i+0],11,-358537222),o=this.md5_hh(o,a,s,n,e[i+3],16,-722521979),n=this.md5_hh(n,o,a,s,e[i+6],23,76029189),s=this.md5_hh(s,n,o,a,e[i+9],4,-640364487),a=this.md5_hh(a,s,n,o,e[i+12],11,-421815835),o=this.md5_hh(o,a,s,n,e[i+15],16,530742520),n=this.md5_hh(n,o,a,s,e[i+2],23,-995338651),s=this.md5_ii(s,n,o,a,e[i+0],6,-198630844),a=this.md5_ii(a,s,n,o,e[i+7],10,1126891415),o=this.md5_ii(o,a,s,n,e[i+14],15,-1416354905),n=this.md5_ii(n,o,a,s,e[i+5],21,-57434055),s=this.md5_ii(s,n,o,a,e[i+12],6,1700485571),a=this.md5_ii(a,s,n,o,e[i+3],10,-1894986606),o=this.md5_ii(o,a,s,n,e[i+10],15,-1051523),n=this.md5_ii(n,o,a,s,e[i+1],21,-2054922799),s=this.md5_ii(s,n,o,a,e[i+8],6,1873313359),a=this.md5_ii(a,s,n,o,e[i+15],10,-30611744),o=this.md5_ii(o,a,s,n,e[i+6],15,-1560198380),n=this.md5_ii(n,o,a,s,e[i+13],21,1309151649),s=this.md5_ii(s,n,o,a,e[i+4],6,-145523070),a=this.md5_ii(a,s,n,o,e[i+11],10,-1120210379),o=this.md5_ii(o,a,s,n,e[i+2],15,718787259),n=this.md5_ii(n,o,a,s,e[i+9],21,-343485551),s=this.safe_add(s,r),n=this.safe_add(n,h),o=this.safe_add(o,c),a=this.safe_add(a,l)}return[s,n,o,a]},e.prototype.md5_cmn=function(e,t,s,n,o,a){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(t,e),this.safe_add(n,a)),o),s)},e.prototype.md5_ff=function(e,t,s,n,o,a,i){return this.md5_cmn(t&s|~t&n,e,t,o,a,i)},e.prototype.md5_gg=function(e,t,s,n,o,a,i){return this.md5_cmn(t&n|s&~n,e,t,o,a,i)},e.prototype.md5_hh=function(e,t,s,n,o,a,i){return this.md5_cmn(t^s^n,e,t,o,a,i)},e.prototype.md5_ii=function(e,t,s,n,o,a,i){return this.md5_cmn(s^(t|~n),e,t,o,a,i)},e.prototype.safe_add=function(e,t){var s=(65535&e)+(65535&t),n=(e>>16)+(t>>16)+(s>>16);return n<<16|65535&s},e.prototype.bit_rol=function(e,t){return e<<t|e>>>32-t},e}();__reflect(MD5.prototype,"MD5");var Toast=function(e){function t(s,n,o){var a=e.call(this)||this;console.log("Toast:",s);var i=new egret.Bitmap(t._txtrToastBg);a.x=.5*n,a.y=.85*o,a.addChild(i),i.$anchorOffsetX=i.width/2;var r=new egret.TextField;return r.multiline=!0,r.size=30,r.bold=!0,r.textColor=16777215,r.stroke=6,r.strokeColor=0,r.text=s,r.fontFamily="微软雅黑",r.textAlign=egret.HorizontalAlign.CENTER,r.width=1*n,r.x=i.x,r.y=i.y+r.size/10,r.anchorOffsetX=r.width/2,a.addChild(r),i.height=12+r.height,a.alpha=0,egret.Tween.get(a).to({alpha:1},800,egret.Ease.quintOut).wait(1600).to({alpha:0},1200,egret.Ease.quintIn).call(function(){a.parent&&a.parent.removeChild(a)}),a}return __extends(t,e),t.init=function(e,t){console.log("Toast.init",t),this._cont=e,this._txtrToastBg=t},t.initRes=function(e,t){console.log("Toast.init",t),this._cont=e;var s=new egret.ImageLoader;s.addEventListener(egret.Event.COMPLETE,function(e){var t=e.target,s=t.data,n=new egret.Texture;n.bitmapData=s,this._txtrToastBg=n},this),s.load(t)},t.show=function(e){if(this._cont){var s=new t(e,this._cont.stage.stageWidth,this._cont.stage.stageHeight);this._cont.addChild(s)}},t}(egret.DisplayObjectContainer);__reflect(Toast.prototype,"Toast");